/*! For license information please see 2b38c15a-8d1f50873d22d5187791.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"z/r+":function(e,t,f){"use strict";(function(e){var r=f("sXyB"),i=f("iWIM"),n=f("7W2i"),s=f("a1gu"),d=f("Nsbk"),o=f("J4zp"),u=f("lwsE"),a=f("W8MJ");function h(e,t){var f;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(f=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var f=Object.prototype.toString.call(e).slice(8,-1);"Object"===f&&e.constructor&&(f=e.constructor.name);if("Map"===f||"Set"===f)return Array.from(e);if("Arguments"===f||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){f&&(e=f);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,d=!1;return{s:function(){f=e[Symbol.iterator]()},n:function(){var e=f.next();return s=e.done,e},e:function(e){d=!0,n=e},f:function(){try{s||null==f.return||f.return()}finally{if(d)throw n}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var f=0,r=new Array(t);f<t;f++)r[f]=e[f];return r}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var f,r=d(e);if(t){var i=d(this).constructor;f=Reflect.construct(r,arguments,i)}else f=r.apply(this,arguments);return s(this,f)}}var v=f("9jQp").custom,b=f("lajS"),y=0,p=1,m=2,S=3,w=[-3,-1,-5,-7,0,7,5,1,3],k=0,I=function(){function t(e,f,r){u(this,t),this.Point=null,this.id=null,this.uid=k++,this.ossl=null,this.type="base",this.endian="be",this.hash=null,this.prefix=null,this.context=!1,this.prime=null,this.p=null,this.red=null,this.fieldSize=0,this.fieldBits=0,this.adjustedSize=0,this.signBit=0,this.mask=0,this.n=null,this.h=null,this.q=null,this.z=null,this.g=null,this.nh=null,this.scalarSize=0,this.scalarBits=0,this.zero=null,this.one=null,this.two=null,this.three=null,this.four=null,this.i2=null,this.i3=null,this.i4=null,this.i6=null,this.torsion=null,this.endo=null,this.hi=null,this._init(e,f,r)}return a(t,[{key:"_init",value:function(t,f,r){H("function"==typeof t),H("string"==typeof f),H(r&&"object"==typeof r),H(null==r.red||r.red instanceof b.Red),H(null!=r.p,"Must pass a prime."),H(null==r.id||"string"==typeof r.id),H(null==r.ossl||"string"==typeof r.ossl),H(null==r.endian||"string"==typeof r.endian),H(null==r.hash||"string"==typeof r.hash),H(null==r.prefix||"string"==typeof r.prefix),H(null==r.context||"boolean"==typeof r.context),H(null==r.prime||"string"==typeof r.prime),H(null==r.torsion||Array.isArray(r.torsion)),this.Point=t,this.id=r.id||null,this.ossl=r.ossl||null,this.type=f,this.endian=r.endian||("short"===f?"be":"le"),this.hash=r.hash||null,this.prefix=r.prefix?e.from(r.prefix,"binary"):null,this.context=r.context||!1,this.prime=r.prime||null,this.p=b.fromJSON(r.p),r.red?this.red=r.red:(this.red=r.prime?b.red(r.prime):b.mont(this.p),this.red.precompute()),this.fieldSize=this.p.byteLength(),this.fieldBits=this.p.bitLength(),this.adjustedSize=this.fieldSize+(0==(7&this.fieldBits)),this.signBit=8*this.adjustedSize-1,this.mask=255,0!=(7&this.fieldBits)&&(this.mask=(1<<(7&this.fieldBits))-1),this.n=b.fromJSON(r.n||"0"),this.h=b.fromJSON(r.h||"1"),this.q=this.n.mul(this.h),this.z=b.fromJSON(r.z||"0").toRed(this.red),this.g=null,this.nh=this.n.ushrn(1),this.scalarSize=this.n.byteLength(),this.scalarBits=this.n.bitLength(),this.zero=new b(0).toRed(this.red),this.one=new b(1).toRed(this.red),this.two=new b(2).toRed(this.red),this.three=new b(3).toRed(this.red),this.four=new b(4).toRed(this.red),this.i2=this.two.redInvert(),this.i3=this.three.redInvert(),this.i4=this.i2.redSqr(),this.i6=this.i2.redMul(this.i3),this.torsion=new Array(this.h.word(0));for(var i=0;i<this.torsion.length;i++)this.torsion[i]=this.point();return this.endo=null,this.hi=null,this._scale=W(this._scale,this),this.isIsomorphic=W(this.isIsomorphic,this),this.isIsogenous=W(this.isIsogenous,this),H(this.p.sign()>0&&this.p.isOdd()),H(this.n.sign()>=0),H(this.h.sign()>0&&this.h.cmpn(255)<=0),H("be"===this.endian||"le"===this.endian),this}},{key:"_finalize",value:function(e){if(H(e&&"object"==typeof e),this.g=e.g?this.pointFromJSON(e.g):this.point(),e.torsion){H(e.torsion.length===this.torsion.length);for(var t=0;t<this.torsion.length;t++)this.torsion[t]=this.pointFromJSON(e.torsion[t])}return this}},{key:"_findTorsion",value:function(){H(!this.n.isZero());for(var e=this.h.word(0),t=this.one.redNeg(),f=[this.point()],r=new Set,i=e;f.length<i;){var n=void 0;t.redIAdd(this.one);try{n=this.pointFromX(t.clone())}catch(a){continue}try{n=n.mul(this.n)}catch(a){i=2;continue}if(!n.isInfinity()){n.normalize();for(var s=0,d=[n,n.neg()];s<d.length;s++){var o=d[s],u=o.key();r.has(u)||(f.push(o),r.add(u))}}}for(f.sort((function(e,t){return e.cmp(t)}));f.length<e;)f.push(this.point());return f}},{key:"_fixedMul",value:function(e,t){H(e instanceof M),H(t instanceof b),H(e.pre&&e.pre.windows);for(var f=e._getWindows(0,0),r=f.width,i=f.points,n=1<<r,s=(t.bitLength()+r-1)/r>>>0,d=this.jpoint(),o=0;o<s;o++){var u=t.bits(o*r,r);d=d.add(i[o*n+u])}return t.isNeg()&&(d=d.neg()),d}},{key:"_fixedNafMul",value:function(e,t){H(e instanceof M),H(t instanceof b),H(e.pre&&e.pre.doubles);for(var f=e._getDoubles(0,0),r=f.step,i=f.points,n=function(e,t,f,r){H(r>>>0===r);for(var i=B(e,t,f),n=Math.ceil(i.length/r),s=new Array(n),d=0,o=0;o<i.length;o+=r){for(var u=0,a=o+r-1;a>=o;a--)u=(u<<1)+i[a];s[d++]=u}return H(d===n),s}(t,2,t.bitLength()+1,r),s=((1<<r+1)-(r%2==0?2:1))/3,d=this.jpoint(),o=this.jpoint(),u=s;u>0;u--){for(var a=0;a<n.length;a++){var h=n[a];h===u?o=o.add(i[a]):h===-u&&(o=o.sub(i[a]))}d=d.add(o)}return d}},{key:"_wnafMul",value:function(e,t,f){H(t instanceof M),H(f instanceof b);for(var r=t._safeNAF(e),i=r.width,n=r.points,s=B(f,i,f.bitLength()+1),d=this.jpoint(),o=s.length-1;o>=0;o--){var u=s[o];o!==s.length-1&&(d=d.dbl()),u>0?d=d.add(n[u-1>>1]):u<0&&(d=d.sub(n[-u-1>>1]))}return d}},{key:"_wnafMulAdd",value:function(e,t,f){H(e>>>0===e),H(Array.isArray(t)),H(Array.isArray(f)),H(t.length===f.length);for(var r=t.length,i=new Array(r),n=new Array(r),s=0,d=0;d<r;d++){var o=t[d],u=f[d];if(H(o instanceof M),H(u instanceof b),d>0&&o.type!==t[d-1].type)throw new Error("Cannot mix points.");i[d]=null,n[d]=null,s=Math.max(s,u.bitLength()+1)}for(var a=null,h=null,l=0,c=0;c<r;c++){var v=t[c],y=f[c],p=v._getNAF(0);p?(i[l]=p.points,n[l]=B(y,p.width,s),l+=1):a?(i[l]=a._getJNAF(v),n[l]=Y(h,y,s),a=null,h=null,l+=1):(a=v,h=y)}if(a){var m=a._safeNAF(e);i[l]=m.points,n[l]=B(h,m.width,s),l+=1}for(var S=this.jpoint(),w=s-1;w>=0;w--){w!==s-1&&(S=S.dbl());for(var k=0;k<l;k++){var I=n[k][w];I>0?S=S.add(i[k][I-1>>1]):I<0&&(S=S.sub(i[k][-I-1>>1]))}}return S}},{key:"_endoWnafMulAdd",value:function(e,t){throw new Error("Not implemented.")}},{key:"_scale",value:function(e,f){switch(H(e instanceof t),H(e.p.eq(this.p)),e.type){case"short":return this._scaleShort(e,f);case"mont":return this._scaleMont(e,f);case"edwards":return this._scaleEdwards(e,f);default:throw new Error("Not implemented.")}}},{key:"_scaleShort",value:function(e,t){throw new Error("Not implemented.")}},{key:"_scaleMont",value:function(e,t){throw new Error("Not implemented.")}},{key:"_scaleEdwards",value:function(e,t){throw new Error("Not implemented.")}},{key:"isElliptic",value:function(){throw new Error("Not implemented.")}},{key:"jinv",value:function(){throw new Error("Not implemented.")}},{key:"isComplete",value:function(){return!1}},{key:"precompute",value:function(e){return H(!this.g.isInfinity(),"Must have base point."),H(!this.n.isZero(),"Must have order."),this.g.precompute(this.n.bitLength(),e),this}},{key:"scalar",value:function(e,t,f){var r=new b(e,t,f);return H(!r.red),this.n.isZero()?r:r.imod(this.n)}},{key:"field",value:function(e,t,f){var r=b.cast(e,t,f);return r.red?r.forceRed(this.red):r.toRed(this.red)}},{key:"point",value:function(e,t){throw new Error("Not implemented.")}},{key:"jpoint",value:function(e,t,f){throw new Error("Not implemented.")}},{key:"xpoint",value:function(e,t){throw new Error("Not implemented.")}},{key:"cpoint",value:function(e,t,f,r){if(H(e instanceof b),H(t instanceof b),H(f instanceof b),H(r instanceof b),t.isZero()||r.isZero())return this.point();var i=t.redMul(r).redInvert(),n=e.redMul(r).redMul(i),s=f.redMul(t).redMul(i);return this.point(n,s)}},{key:"solveX2",value:function(e){throw new Error("Not implemented.")}},{key:"solveX",value:function(e){return this.solveX2(e).redSqrt()}},{key:"solveY2",value:function(e){throw new Error("Not implemented.")}},{key:"solveY",value:function(e){return this.solveY2(e).redSqrt()}},{key:"validate",value:function(e){throw new Error("Not implemented.")}},{key:"pointFromX",value:function(e,t){throw new Error("Not implemented.")}},{key:"pointFromY",value:function(e,t){throw new Error("Not implemented.")}},{key:"isIsomorphic",value:function(e){throw new Error("Not implemented.")}},{key:"isIsogenous",value:function(e){throw new Error("Not implemented.")}},{key:"pointFromShort",value:function(e){throw new Error("Not implemented.")}},{key:"pointFromMont",value:function(e,t){throw new Error("Not implemented.")}},{key:"pointFromEdwards",value:function(e){throw new Error("Not implemented.")}},{key:"pointFromUniform",value:function(e){throw new Error("Not implemented.")}},{key:"pointToUniform",value:function(e){throw new Error("Not implemented.")}},{key:"pointFromHash",value:function(t){var f=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(H(e.isBuffer(t)),H("boolean"==typeof f),t.length!==2*this.fieldSize)throw new Error("Invalid hash size.");var r=t.slice(0,this.fieldSize),i=t.slice(this.fieldSize),n=this.decodeUniform(r),s=this.decodeUniform(i),d=this.pointFromUniform(n),o=this.pointFromUniform(s),u=d.add(o);return f?u.mulH():u}},{key:"pointToHash",value:function(t,f,r){H(t instanceof this.Point),H(f>>>0===f);for(var i=f%this.torsion.length,n=t.add(this.torsion[i]);;){var s=this.randomField(r),d=this.pointFromUniform(s);if(!d.neg().eq(d)){var o=n.sub(d),u=T(r),a=void 0;try{a=this.pointToUniform(o,15&u)}catch(c){if("Invalid point."===c.message)continue;throw c}var h=this.encodeUniform(s,u>>>8),l=this.encodeUniform(a,u>>>16);return e.concat([h,l])}}}},{key:"randomScalar",value:function(e){var t=this.n.isZero()?this.p:this.n;return b.random(e,1,t)}},{key:"randomField",value:function(e){return b.random(e,1,this.p).toRed(this.red)}},{key:"randomPoint",value:function(e){for(var t;;){var f=this.randomField(e),r=0!=(1&T(e));try{t=this.pointFromX(f,r)}catch(i){continue}return H(t.validate()),t.mulH()}}},{key:"mulAll",value:function(e,t){return this.jmulAll(e,t)}},{key:"jmulAll",value:function(e,t){return H(Array.isArray(e)),H(0===e.length||e[0]instanceof M),this.endo&&e.length>0&&e[0].type===y?this._endoWnafMulAdd(e,t):this._wnafMulAdd(5,e,t)}},{key:"mulH",value:function(e){return H(e instanceof b),this.imulH(e.clone())}},{key:"imulH",value:function(e){H(e instanceof b),H(!e.red);var t=this.h.word(0);if(0==(t&t-1)){var f=this.h.bitLength();return e.iushln(f-1).imod(this.n)}return e.imuln(t).imod(this.n)}},{key:"normalizeAll",value:function(e){H(Array.isArray(e));for(var t=e.length,f=new Array(t),r=0;r<t;r++){var i=e[r];H(i instanceof M),H(i.curve===this),i.type!==y?f[r]=i.z:f[r]=this.one}for(var n=this.red.invertAll(f),s=new Array(t),d=0;d<t;d++)s[d]=e[d].scale(n[d]);return s}},{key:"affinizeAll",value:function(e){return this.normalizeAll(e)}},{key:"clamp",value:function(t){H(e.isBuffer(t)),H(t.length===this.scalarSize),H(this.scalarSize<=this.fieldSize);var f=7&this.fieldBits||8,r=0,i=this.scalarSize-1;if("be"===this.endian){var n=[i,r];r=n[0],i=n[1]}return this.scalarSize<this.fieldSize&&(f=8),t[r]&=255&-this.h.word(0),t[i]&=(1<<f)-1,t[i]|=1<<f-1,t}},{key:"splitHash",value:function(t){H(e.isBuffer(t)),H(t.length===2*this.adjustedSize),H(this.scalarSize<=this.adjustedSize);var f=0;"be"===this.endian&&(f=this.adjustedSize-this.scalarSize);var r=t.slice(f,f+this.scalarSize),i=t.slice(this.adjustedSize);return this.clamp(r),[r,i]}},{key:"encodeField",value:function(e){return H(e instanceof b),H(!e.red),e.encode(this.endian,this.fieldSize)}},{key:"decodeField",value:function(t){if(H(e.isBuffer(t)),t.length!==this.fieldSize)throw new Error("Invalid field element size.");return b.decode(t,this.endian)}},{key:"encodeAdjusted",value:function(e){return H(e instanceof b),H(!e.red),e.encode(this.endian,this.adjustedSize)}},{key:"decodeAdjusted",value:function(t){if(H(e.isBuffer(t)),t.length!==this.adjustedSize)throw new Error("Invalid field element size.");return b.decode(t,this.endian)}},{key:"encodeScalar",value:function(e){return H(e instanceof b),H(!e.red),e.encode(this.endian,this.scalarSize)}},{key:"decodeScalar",value:function(t){if(H(e.isBuffer(t)),t.length!==this.scalarSize)throw new Error("Invalid scalar size.");return b.decode(t,this.endian)}},{key:"encodeClamped",value:function(e){return this.clamp(this.encodeScalar(e))}},{key:"decodeClamped",value:function(t){if(H(e.isBuffer(t)),t.length!==this.scalarSize)throw new Error("Invalid scalar size.");var f=this.clamp(e.from(t));return b.decode(f,this.endian)}},{key:"encodeUniform",value:function(e,t){H(e instanceof b),H(t>>>0===t);var f="le"===this.endian?this.fieldSize-1:0,r=e.fromRed().encode(this.endian,this.fieldSize);return r[f]|=t&~this.mask&255,r}},{key:"decodeUniform",value:function(t){if(H(e.isBuffer(t)),t.length!==this.fieldSize)throw new Error("Invalid field size.");var f=b.decode(t,this.endian);return f.iumaskn(this.fieldBits),f.toRed(this.red)}},{key:"encodePoint",value:function(e,t){return H(e instanceof M),e.encode(t)}},{key:"decodePoint",value:function(e){throw new Error("Not implemented.")}},{key:"encodeX",value:function(e){throw new Error("Not implemented.")}},{key:"decodeX",value:function(e){throw new Error("Not implemented.")}},{key:"decodeEven",value:function(e){throw new Error("Not implemented.")}},{key:"decodeSquare",value:function(e){throw new Error("Not implemented.")}},{key:"toShort",value:function(){throw new Error("Not implemented.")}},{key:"toMont",value:function(e){throw new Error("Not implemented.")}},{key:"toEdwards",value:function(e){throw new Error("Not implemented.")}},{key:"pointToJSON",value:function(e,t){return H(e instanceof M),e.toJSON(t)}},{key:"pointFromJSON",value:function(e){throw new Error("Not implemented.")}},{key:"toJSON",value:function(e){var t,f,r,i,n;return"edwards"===this.type&&(t=this.prefix?this.prefix.toString():null,f=this.context),this.n.isZero()||(r=this.n.toJSON()),this.z.isZero()||(i=this.z.fromRed(),this.z.redIsHigh()&&i.isub(this.p),i=i.toString(16)),this.endo&&(n=this.endo.toJSON()),{id:this.id,ossl:this.ossl,type:this.type,endian:this.endian,hash:this.hash,prefix:t,context:f,prime:this.prime,p:this.p.toJSON(),a:void 0,b:void 0,d:void 0,n:r,h:this.h.toString(16),s:void 0,z:i,c:void 0,g:this.g.toJSON(e),endo:n}}}],[{key:"fromJSON",value:function(e){return new this(e)}}]),t}(),M=function(){function e(t,f){u(this,e),H(t instanceof I),H(f>>>0===f),this.curve=t,this.type=f,this.pre=null}return a(e,[{key:"_init",value:function(){throw new Error("Not implemented.")}},{key:"_safeNAF",value:function(e){if(H(e>>>0===e),this.pre&&this.pre.naf)return this.pre.naf;if(0===e)return null;var t=1<<e-2,f=new Array(t),r=this.toJ(),i=1===t?null:r.dbl();f[0]=r;for(var n=1;n<t;n++)f[n]=f[n-1].add(i);return new J(e,f)}},{key:"_getNAF",value:function(e){if(H(e>>>0===e),this.pre&&this.pre.naf)return this.pre.naf;if(0===e)return null;var t=this._safeNAF(e).points,f=this.curve.affinizeAll(t);return new J(e,f)}},{key:"_getWindows",value:function(e,t){if(H(e>>>0===e),H(t>>>0===t),this.pre&&this.pre.windows)return this.pre.windows;if(0===e)return null;for(var f=1<<e,r=(t+e-1)/e>>>0,i=new Array(r*f),n=this.toJ(),s=0;s<r;s++){i[s*f]=this.curve.jpoint();for(var d=1;d<f;d++)i[s*f+d]=i[s*f+d-1].add(n);n=n.dblp(e)}var o=this.curve.affinizeAll(i);return new P(e,t,o)}},{key:"_getDoubles",value:function(e,t){if(H(e>>>0===e),H(t>>>0===t),this.pre&&this.pre.doubles)return this.pre.doubles;if(0===e)return null;var f=Math.ceil(t/e)+1,r=new Array(f),i=this.toJ(),n=0;r[n++]=i;for(var s=0;s<t;s+=e){for(var d=0;d<e;d++)i=i.dbl();r[n++]=i}H(n===f);var o=this.curve.affinizeAll(r);return new R(e,o)}},{key:"_getBeta",value:function(){return null}},{key:"_getBlinding",value:function(e){if(this.pre&&this.pre.blinding)return this.pre.blinding;if(!e)return null;if(this.curve.n.isZero())return null;var t=this.curve.randomScalar(e),f=this.mul(t);return new Z(t,f)}},{key:"_hasWindows",value:function(e){if(H(e instanceof b),!this.pre||!this.pre.windows)return!1;var t=this.pre.windows,f=t.width,r=(t.bits+f-1)/f>>>0;return e.bitLength()<=r*f}},{key:"_hasDoubles",value:function(e){if(H(e instanceof b),!this.pre||!this.pre.doubles)return!1;var t=this.pre.doubles,f=t.step,r=t.points,i=e.bitLength()+1;return r.length>=Math.ceil(i/f)+1}},{key:"_getJNAF",value:function(t){return H(t instanceof e),H(t.type===this.type),[this,this.add(t),this.sub(t),t]}},{key:"_blind",value:function(e,t){if(H(e instanceof b),H(!e.red),this.pre&&this.pre.blinding){var f=this.pre.blinding,r=f.blind,i=f.unblind;return[this,e.sub(r),i]}return t?this.pre?this.curve.n.isZero()?[this,e,null]:[this,this.curve.randomScalar(t).mul(this.curve.n).iadd(e),null]:[this.randomize(t),e,null]:[this,e,null]}},{key:"clone",value:function(){throw new Error("Not implemented.")}},{key:"precompute",value:function(e,t){return H(e>>>0===e),this.pre||(this.pre=new E),this.pre.naf||(this.pre.naf=this._getNAF(9)),this.pre.doubles||(this.pre.doubles=this._getDoubles(4,e+1)),this.pre.beta||(this.pre.beta=this._getBeta()),this.pre.blinding||(this.pre.blinding=this._getBlinding(t)),this}},{key:"validate",value:function(){return this.curve.validate(this)}},{key:"normalize",value:function(){return this}},{key:"scale",value:function(e){throw new Error("Not implemented.")}},{key:"randomize",value:function(e){var t=this.curve.randomField(e);return this.scale(t)}},{key:"neg",value:function(){throw new Error("Not implemented.")}},{key:"add",value:function(e){throw new Error("Not implemented.")}},{key:"sub",value:function(t){return H(t instanceof e),this.add(t.neg())}},{key:"dbl",value:function(){throw new Error("Not implemented.")}},{key:"dblp",value:function(e){H(e>>>0===e);for(var t=this,f=0;f<e;f++)t=t.dbl();return t}},{key:"diffAddDbl",value:function(e,t){throw new Error("Not implemented.")}},{key:"getX",value:function(){throw new Error("Not implemented.")}},{key:"getY",value:function(){throw new Error("Not implemented.")}},{key:"eq",value:function(e){throw new Error("Not implemented.")}},{key:"cmp",value:function(e){throw new Error("Not implemented.")}},{key:"isInfinity",value:function(){throw new Error("Not implemented.")}},{key:"isOrder2",value:function(){throw new Error("Not implemented.")}},{key:"isOdd",value:function(){throw new Error("Not implemented.")}},{key:"isEven",value:function(){throw new Error("Not implemented.")}},{key:"isSquare",value:function(){throw new Error("Not implemented.")}},{key:"eqX",value:function(e){throw new Error("Not implemented.")}},{key:"eqR",value:function(e){throw new Error("Not implemented.")}},{key:"isSmall",value:function(){return!this.isInfinity()&&this.jmulH().isInfinity()}},{key:"hasTorsion",value:function(){return!this.isInfinity()&&!this.jmul(this.curve.n).isInfinity()}},{key:"order",value:function(){for(var e=this.curve,t=e.h,f=e.n,r=this.toJ(),i=new b(1);!r.isInfinity();){if(i.iaddn(1),i.cmp(t)>0){i=f.clone();break}r=r.add(this)}return i}},{key:"mul",value:function(e){return this.jmul(e)}},{key:"muln",value:function(e){return this.jmuln(e)}},{key:"mulBlind",value:function(e,t){return this.jmulBlind(e,t)}},{key:"mulAdd",value:function(e,t,f){return this.jmulAdd(e,t,f)}},{key:"mulH",value:function(){return this.jmulH()}},{key:"div",value:function(e){return this.jdiv(e)}},{key:"divn",value:function(e){return this.jdivn(e)}},{key:"divH",value:function(){return this.jdivH()}},{key:"jmul",value:function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo&&this.type===y?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(5,this,e)}},{key:"jmuln",value:function(e){return H((0|e)===e),this.jmul(new b(e))}},{key:"jmulBlind",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,f=this._blind(e,t),r=o(f,3),i=r[0],n=r[1],s=r[2],d=i.jmul(n);return s?d.add(s):d}},{key:"jmulAdd",value:function(e,t,f){return this.curve.endo&&this.type===y?this.curve._endoWnafMulAdd([this,t],[e,f]):this.curve._wnafMulAdd(5,[this,t],[e,f])}},{key:"jmulH",value:function(){var e=this.curve.h.word(0);if(0==(e&e-1)){var t=this.curve.h.bitLength();return this.toJ().dblp(t-1)}return this.jmul(this.curve.h)}},{key:"jdiv",value:function(e){return H(e instanceof b),H(!e.red),this.jmul(e.invert(this.curve.n))}},{key:"jdivn",value:function(e){return H(!this.curve.n.isZero()),0===this.curve.h.cmpn(e)?this.jdivH():this.jdiv(new b(e))}},{key:"jdivH",value:function(){return this.curve.n.isZero()||0===this.curve.h.cmpn(1)?this.toJ():(null===this.curve.hi&&(this.curve.hi=this.curve.h.invert(this.curve.n)),this.jmul(this.curve.hi))}},{key:"toP",value:function(){return this.normalize()}},{key:"toJ",value:function(){return this}},{key:"toX",value:function(){return this}},{key:"key",value:function(){if(this.isInfinity())return"".concat(this.curve.uid,":oo");this.normalize();var e=this.getX().toString(16),t=this.getY().toString(16);return"".concat(this.curve.uid,":").concat(e,",").concat(t)}},{key:"encode",value:function(e){throw new Error("Not implemented.")}},{key:"encodeX",value:function(){throw new Error("Not implemented.")}},{key:"toJSON",value:function(e){throw new Error("Not implemented.")}},{key:v,value:function(){return"<Point>"}}],[{key:"decode",value:function(e,t){throw new Error("Not implemented.")}},{key:"decodeX",value:function(e,t){throw new Error("Not implemented.")}},{key:"decodeEven",value:function(e,t){throw new Error("Not implemented.")}},{key:"decodeSquare",value:function(e,t){throw new Error("Not implemented.")}},{key:"fromJSON",value:function(e,t){throw new Error("Not implemented.")}}]),e}(),g=function(e){n(f,e);var t=c(f);function f(e){var r;return u(this,f),(r=t.call(this,N,"short",e)).a=b.fromJSON(e.a).toRed(r.red),r.b=b.fromJSON(e.b).toRed(r.red),r.c=b.fromJSON(e.c||"0").toRed(r.red),r.ai=r.a.isZero()?r.zero:r.a.redInvert(),r.zi=r.z.isZero()?r.zero:r.z.redInvert(),r.zeroA=r.a.isZero(),r.threeA=r.a.eq(r.three.redNeg()),r.redN=r.n.toRed(r.red),r.pmodn=r.p.clone(),r.highOrder=r.n.cmp(r.p)>=0,r.smallGap=!1,r._finalize(e),r}return a(f,[{key:"_finalize",value:function(e){return i(d(f.prototype),"_finalize",this).call(this,e),null!=e.endo?this.endo=F.fromJSON(this,e.endo):this.endo=this._getEndomorphism(),this.n.isZero()||(this.pmodn=this.p.mod(this.n),this.smallGap=this.p.div(this.n).cmpn(1)<=0),this}},{key:"_short",value:function(e,t){return f._isomorphism(this.a,this.b,e,t)}},{key:"_mont",value:function(e,t){var f=this._findRS(t),r=o(f,2),i=r[0],n=r[1].redInvert(),s=i.redMuln(3).redMul(n);return null!=e?q._isomorphism(s,n,e):[s,n]}},{key:"_edwards",value:function(e,t){var f=this._findRS(t),r=o(f,2),i=r[0],n=r[1],s=i.redMuln(3),d=n.redMuln(2),u=s.redAdd(d),a=s.redSub(d);return null!=e?x._isomorphism(u,a,e):[u,a]}},{key:"_findRS",value:function(e){H(null==e||"boolean"==typeof e),H(this.h.word(0)>=4),H(!this.n.isZero());for(var t,f=this.one.redNeg();;){f.redIAdd(this.one);try{t=this.pointFromX(f.clone())}catch(n){continue}if(!(t=t.mul(this.n)).isInfinity()&&t.y.isZero())break}var r=t.x,i=r.redSqr().redMuln(3).redIAdd(this.a).redSqrt();return null!=e&&i.redIsOdd()!==e&&i.redINeg(),[r,i]}},{key:"_scale0",value:function(e,t){if(H(this.a.isZero()===e.isZero()),H(this.b.isZero()===t.isZero()),this.a.isZero()){var f=this.b.redDiv(this.field(t)),r=U(f),i=r.redSqrt(),n=r.redMul(i);return H(n.redSqr().eq(f)),H(!i.isZero()),[r,n]}if(this.b.isZero()){var s=this.a.redDiv(this.field(e)),d=s.redSqrt();1!==d.redJacobi()&&d.redINeg();var o=d.redSqrt(),u=d.redMul(o);return H(u.redMul(o).eq(s)),H(!o.isZero()),[d,u]}var a=this.a.redDiv(this.field(e)),h=this.b.redDiv(this.field(t)),l=a.redSqrt();a.redMul(l).eq(h)||l.redINeg(),H(a.redMul(l).eq(h));var c=l.redSqrt(),v=l.redMul(c);return H(!c.isZero()),[l,v]}},{key:"_scale1",value:function(e,t){var f=this.g.x.redDiv(this.field(e)),r=this.g.y.redDiv(this.field(t)),i=f.redSqrt();return f.redMul(i).eq(r)||i.redINeg(),H(f.redMul(i).eq(r)),H(!i.isZero()),[f,r]}},{key:"_scaleShort",value:function(e){return H(e instanceof f),this.g.isInfinity()||e.g.isInfinity()?this._scale0(e.a,e.b):this._scale1(e.g.x,e.g.y)}},{key:"_scaleMont",value:function(e){if(H(e instanceof q),this.g.isInfinity()||e.g.isInfinity()){var t=e._short(),f=o(t,2),r=f[0],i=f[1];return this._scale0(r,i)}var n=e.g,s=n.x,d=n.y,u=s.redAdd(e.a3).redMul(e.bi),a=d.redMul(e.bi);return this._scale1(u,a)}},{key:"_scaleEdwards",value:function(e){if(H(e instanceof x),this.g.isInfinity()||e.g.isInfinity()){var t=e._short(),f=o(t,2),r=f[0],i=f[1];return this._scale0(r,i)}var n=e.g,s=n.x,d=n.y,u=n.z,a=e.a.redMuln(5),h=e.d.redMuln(5),l=e.d.redSub(e.a),c=h.redSub(e.a),v=e.d.redSub(a),b=d.redAdd(u),y=d.redSub(u),p=c.redMul(d).redIAdd(v.redMul(u)),m=y.redMuln(12),S=l.redMul(b).redMul(u),w=y.redMul(s).redIMuln(4),k=m.redMul(w).redInvert(),I=p.redMul(w).redMul(k),M=S.redMul(m).redMul(k);return this._scale1(I,M)}},{key:"_getEndomorphism",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.n.isZero()||this.g.isInfinity())return null;if(!this.zeroA||1!==this.p.modrn(3)||1!==this.n.modrn(3))return null;var t,f=this._getEndoRoots(this.p),r=o(f,2),i=r[0],n=r[1],s=[i,n][1&e].toRed(this.red),d=this._getEndoRoots(this.n),u=o(d,2),a=u[0],h=u[1],l=this.point(this.g.x.redMul(s),this.g.y);this.g.mul(a).eq(l)?t=a:(H(this.g.mul(h).eq(l)),t=h);var c=this._getEndoBasis(t),v=this._getEndoPrecomp(c);return new F(s,t,c,v)}},{key:"_getEndoRoots",value:function(e){var t=e===this.p?this.red:b.mont(e),f=new b(2).toRed(t),r=new b(3).toRed(t),i=f.redInvert(),n=r.redNeg().redSqrt().redMul(i),s=n.redNeg();return[n.redSub(i).fromRed(),s.redSub(i).fromRed()].sort(b.cmp)}},{key:"_getEndoBasis",value:function(e){var t,f,r=this._egcdSqrt(e),i=o(r,6),n=i[0],s=i[1],d=i[2],u=i[3],a=i[4],h=i[5],l=d,c=u.neg(),v=n.sqr().iadd(s.sqr()),b=a.sqr().iadd(h.sqr());return v.cmp(b)<=0?(t=n,f=s.neg()):(t=a,f=h.neg()),[new j(l,c),new j(t,f)]}},{key:"_egcdSqrt",value:function(e){H(e instanceof b),H(!e.red),H(e.sign()>0),H(this.n.sign()>0);for(var t,f,r,i,n,s=this.n.ushrn(this.n.bitLength()>>>1),d=e,o=this.n.clone(),u=new b(1),a=new b(0),h=new b(0),l=new b(1),c=0,v=0;!d.isZero()&&c<2;){var y=o.quo(d),p=o.sub(y.mul(d)),m=h.sub(y.mul(u)),S=l.sub(y.mul(a));0===v&&p.cmp(s)<0&&(t=n,f=u,r=p,i=m,v=1),n=p,o=d,d=p,h=u,u=m,l=a,a=S,c+=v}return H(0!==v,"Could not find r < sqrt(n)."),[t,f,r,i,h,u]}},{key:"_getEndoPrecomp",value:function(e){H(Array.isArray(e)),H(2===e.length),H(e[0]instanceof j),H(e[1]instanceof j);var t=o(e,2),f=t[0],r=t[1],i=f.a.mul(r.b).isub(f.b.mul(r.a)),n=i.bitLength(),s=n>=160;H(i.eq(this.n));var d,u,a=n+Math.ceil(n/2)+1;for(s&&(a-=63&a);a>n&&(d=r.b.ushln(a).divRound(i),u=f.b.ushln(a).divRound(i),!(d.ucmp(i)<0&&u.ucmp(i)<0));)a-=s?64:1;if(a<=n)throw new Error("Could not calculate g1 and g2.");return[a,d,u]}},{key:"_endoSplit",value:function(e){H(e instanceof b),H(!e.red),H(!this.n.isZero());var t=o(this.endo.basis,2),f=t[0],r=t[1],i=r.b.mul(e).divRound(this.n),n=f.b.neg().mul(e).divRound(this.n),s=i.mul(f.a),d=n.mul(r.a),u=i.ineg().mul(f.b),a=n.mul(r.b);return[e.sub(s).isub(d),u.isub(a)]}},{key:"_endoBeta",value:function(e){return H(e instanceof N),[e,e._getBeta()]}},{key:"_endoWnafMulAdd",value:function(e,t){H(Array.isArray(e)),H(Array.isArray(t)),H(e.length===t.length),H(null!=this.endo);for(var f=e.length,r=new Array(2*f),i=new Array(2*f),n=0;n<f;n++){var s=this._endoBeta(e[n]),d=o(s,2),u=d[0],a=d[1],h=this._endoSplit(t[n]),l=o(h,2),c=l[0],v=l[1];r[2*n+0]=u,i[2*n+0]=c,r[2*n+1]=a,i[2*n+1]=v}return this._wnafMulAdd(5,r,i)}},{key:"_sswu",value:function(e){var t=this.b,f=this.z,r=this.ai,i=this.zi,n=this.one,s=f.redSqr(),d=t.redNeg().redMul(r),o=t.redMul(i).redMul(r),u=e.redSqr(),a=u.redSqr(),h=s.redMul(a).redIAdd(f.redMul(u)),l=h.isZero()?h:h.redInvert(),c=l.isZero()?o:d.redMul(n.redAdd(l)),v=f.redMul(u).redMul(c),b=this.solveY2(c),y=this.solveY2(v),p=0|b.redIsSquare(),m=[c,v][1^p],S=[b,y][1^p].redSqrt();return S.redIsOdd()!==e.redIsOdd()&&S.redINeg(),this.point(m,S)}},{key:"_sswui",value:function(e,t){var f=this.a,r=this.b,i=this.z,n=e.x,s=e.y,d=3&t,o=f.redSqr().redMul(n.redSqr()),u=f.redMul(r).redMul(n).redIMuln(2),a=r.redSqr().redMuln(3),h=f.redMul(n).redIAdd(r),l=o.redISub(u).redISub(a).redSqrt(),c=h.redSub(l).redINeg(),v=h.redAdd(l).redINeg(),b=[h.redMul(i).redIMuln(2),r.redMul(i).redIMuln(2)][d>>>1],y=[c,v][1&d].redDivSqrt(b);return y.redIsOdd()!==s.redIsOdd()&&y.redINeg(),y}},{key:"_svdwf",value:function(e){var t=this.c,f=this.z,r=this.zi,i=this.i2,n=this.i3,s=this.solveY2(f),d=n.redMul(r.redSqr()),o=e.redSqr(),u=o.redSqr(),a=o.redAdd(s),h=o.redMul(a),l=h.isZero()?h:h.redInvert(),c=u.redMul(l).redMul(t),v=a.redSqr().redMul(a),b=t.redSub(f).redMul(i).redISub(c),y=c.redSub(t.redAdd(f).redMul(i)),p=f.redSub(v.redMul(l).redMul(d)),m=this.solveY2(b),S=this.solveY2(y),w=this.solveY2(p),k=function(e,t){var f=e%t;f<0&&(t<0?f-=t:f+=t);return f}(((1|m.redJacobi())-1)*(1|S.redJacobi()),3);return[[b,y,p][k],[m,S,w][k]]}},{key:"_svdw",value:function(e){var t=this._svdwf(e),f=o(t,2),r=f[0],i=f[1].redSqrt();return i.redIsOdd()!==e.redIsOdd()&&i.redINeg(),this.point(r,i)}},{key:"_svdwi",value:function(e,t){var f=this.b,r=this.c,i=this.z,n=this.zero,s=this.two,d=e.x,u=e.y,a=3&t,h=i.redSqr(),l=h.redMul(i),c=h.redSqr(),v=l.redAdd(f),b=v.redMuln(2),y=d.redSqr(),p=d.redMuln(2).redIAdd(i),m=d.redMul(h),S=r.redSub(p),w=r.redAdd(p),k=y.redMul(h).redIAdd(c).redIMuln(9),I=d.redMul(l).redIMuln(18),M=v.redMul(d.redSub(i)).redIMuln(12),g=(a>=2?k.redISub(I).redIAdd(M).redSqrt():n).redMul(i),N=l.redISub(m).redIMuln(3).redISub(b),z=v.redMul(S),q=v.redMul(w),A=N.redAdd(g),_=N.redSub(g),x=[w,S,s,s][a],O=[z,q,A,_][a].redDivSqrt(x),E=this._svdwf(O);if(!o(E,1)[0].eq(d))throw new Error("Invalid point.");return O.redIsOdd()!==u.redIsOdd()&&O.redINeg(),O}},{key:"isElliptic",value:function(){var e=this.a,t=this.b,f=e.redSqr().redMul(e);return!t.redSqr().redMuln(27).redIAdd(f.redMuln(4)).isZero()}},{key:"jinv",value:function(){var e=this.a,t=this.b,f=e.redSqr().redMul(e),r=t.redSqr(),i=f.redMuln(4),n=i.redMuln(1728),s=r.redMuln(27).redIAdd(i);if(s.isZero())throw new Error("Curve is not elliptic.");return n.redDiv(s).fromRed()}},{key:"point",value:function(e,t){return new N(this,e,t)}},{key:"jpoint",value:function(e,t,f){return new z(this,e,t,f)}},{key:"solveX",value:function(e){if(H(e instanceof b),!this.a.isZero())throw new Error("Not implemented.");return C(e.redSqr().redSub(this.b))}},{key:"solveY2",value:function(e){H(e instanceof b);var t=e.redSqr().redMul(e).redIAdd(this.b);return this.zeroA||(this.threeA?t.redIAdd(e.redMuln(-3)):t.redIAdd(this.a.redMul(e))),t}},{key:"validate",value:function(e){if(H(e instanceof N),e.inf)return!0;var t=e.x,f=e.y,r=this.solveY2(t);return f.redSqr().eq(r)}},{key:"pointFromX",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;H(e instanceof b),H(null==t||"boolean"==typeof t),e.red||(e=e.toRed(this.red));var f=this.solveY(e);if(null!=t){if(this.h.cmpn(1)>0&&f.isZero()&&t)throw new Error("Invalid point.");f.redIsOdd()!==t&&f.redINeg()}return this.point(e,f)}},{key:"pointFromY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;H(e instanceof b),H(t>>>0===t),e.red||(e=e.toRed(this.red));var f=this.solveX(e);if(t>=f.length)throw new Error("Invalid X coordinate index.");var r=f[t];return this.point(r,e)}},{key:"isIsomorphic",value:function(e){if(H(e instanceof I),!e.p.eq(this.p))return!1;var t,f;try{var r=this._scale(e),i=o(r,2);t=i[0],f=i[1]}catch(l){return!1}if("short"===e.type){var n=this.field(e.a).redMul(t.redSqr()),s=this.field(e.b).redMul(f.redSqr());return this.a.eq(n)&&this.b.eq(s)}if("mont"===e.type){var d=e.a3,u=e.bi,a=this.field(d.redMul(u)).redMul(t);return this.solveY2(a).isZero()}if("edwards"===e.type){var h=this.field(e.ad6).redMul(t);return this.solveY2(h).isZero()}return!1}},{key:"isIsogenous",value:function(e){return H(e instanceof I),!1}},{key:"pointFromShort",value:function(e){if(H(e instanceof N),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();var t=this._scale(e.curve),f=o(t,2),r=f[0],i=f[1],n=this.field(e.x),s=this.field(e.y),d=n.redMul(r),u=s.redMul(i);return this.point(d,u)}throw new Error("Not implemented.")}},{key:"pointFromMont",value:function(e){if(H(e instanceof A),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();var t=e.curve,f=t.a3,r=t.bi,i=this._scale(e.curve),n=o(i,2),s=n[0],d=n[1],u=e.x.redAdd(f).redMul(r),a=e.y.redMul(r);return this.point(this.field(u).redMul(s),this.field(a).redMul(d))}throw new Error("Not implemented.")}},{key:"pointFromEdwards",value:function(e){if(H(e instanceof O),this.isIsomorphic(e.curve)){var t=e.curve,f=t.a,r=t.d,i=t.ad6,n=this._scale(e.curve),s=o(n,2),d=s[0],u=s[1];if(e.isInfinity())return this.point();if(e.x.isZero()){var a=this.field(i).redMul(d);return this.point(a,this.zero)}var h=e.x,l=e.y,c=e.z,v=f.redMuln(5),b=r.redMuln(5),y=r.redSub(f),p=b.redSub(f),m=r.redSub(v),S=l.redAdd(c),w=l.redSub(c),k=p.redMul(l).redIAdd(m.redMul(c)),I=w.redMuln(12),M=y.redMul(S).redMul(c),g=w.redMul(h).redIMuln(4);return this.cpoint(this.field(k).redMul(d),this.field(I),this.field(M).redMul(u),this.field(g))}throw new Error("Not implemented.")}},{key:"pointFromUniform",value:function(e){if(H(e instanceof b),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(!this.a.isZero())return this._sswu(e);if(!this.c.isZero())return this._svdw(e);throw new Error("Not implemented.")}},{key:"pointToUniform",value:function(e,t){var f=this;if(H(e instanceof N),H(t>>>0===t),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(e.isInfinity())throw new Error("Invalid point.");var r=(t>>>4&15)%this.torsion.length,i=e.add(this.torsion[r]);return L((function(){if(!f.a.isZero())return f._sswui(i,t);if(!f.c.isZero())return f._svdwi(i,t);throw new Error("Not implemented.")}))}},{key:"mulAll",value:function(e,t){return i(d(f.prototype),"mulAll",this).call(this,e,t).toP()}},{key:"affinizeAll",value:function(e){for(var t=this.normalizeAll(e),f=0;f<t.length;f++)t[f]=t[f].toP();return t}},{key:"decodePoint",value:function(e){return N.decode(this,e)}},{key:"encodeX",value:function(e){return H(e instanceof M),e.encodeX()}},{key:"decodeEven",value:function(e){return N.decodeEven(this,e)}},{key:"decodeSquare",value:function(e){return N.decodeSquare(this,e)}},{key:"toShort",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this._short(e,t),n=o(i,2),s=n[0],d=n[1],u=new f({red:this.red,prime:this.prime,p:this.p,a:s,b:d,n:this.n,h:this.h});if(null!=r){var a=u._scale(this),h=o(a,2),l=h[1];l.redIsOdd()!==r&&l.redINeg()}this.g.isInfinity()||(u.g=u.pointFromShort(this.g));for(var c=0;c<this.h.word(0);c++)u.torsion[c]=u.pointFromShort(this.torsion[c]);return u}},{key:"toMont",value:function(e,t){var f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this._mont(e,t),i=o(r,2),n=i[0],s=i[1],d=new q({red:this.red,prime:this.prime,p:this.p,a:n,b:s,n:this.n,h:this.h});if(null!=f){var u=this._scale(d),a=o(u,2),h=a[1];h.redIsOdd()!==f&&h.redINeg()}this.g.isInfinity()||(d.g=d.pointFromShort(this.g));for(var l=0;l<this.h.word(0);l++)d.torsion[l]=d.pointFromShort(this.torsion[l]);return d}},{key:"toEdwards",value:function(e,t){var f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this._edwards(e,t),i=o(r,2),n=i[0],s=i[1],d=new x({red:this.red,prime:this.prime,p:this.p,a:n,d:s,n:this.n,h:this.h});if(null!=f){var u=this._scale(d),a=o(u,2),h=a[1];h.redIsOdd()!==f&&h.redINeg()}if(this.g.isInfinity()||(d.g=d.pointFromShort(this.g),d.g.normalize()),d.isComplete())for(var l=0;l<this.h.word(0);l++)d.torsion[l]=d.pointFromShort(this.torsion[l]),d.torsion[l].normalize();return d}},{key:"pointFromJSON",value:function(e){return N.fromJSON(this,e)}},{key:"toJSON",value:function(e){var t=i(d(f.prototype),"toJSON",this).call(this,e);return t.a=this.a.fromRed().toJSON(),t.b=this.b.fromRed().toJSON(),this.c.isZero()||(t.c=this.c.fromRed().toJSON()),t}}],[{key:"_isomorphism",value:function(e,t,f,r){if(H(e instanceof b),H(t instanceof b),H(f instanceof b),H(null==r||"boolean"==typeof r),H(!e.isZero()||!t.isZero()),f.isZero())throw new Error("Invalid coefficient.");if(e.isZero()){var i=f;return H(1===U(i.redDiv(t)).redJacobi()),[e.clone(),i.clone()]}if(t.isZero()){var n=f,s=n.redDiv(e).redSqrt();if(1!==s.redJacobi()&&s.redINeg(),1!==s.redJacobi())throw new Error("Invalid `a` coefficient.");return[n.clone(),t.clone()]}var d=f,o=d.redDiv(e),u=o.redSqrt();if(null!=r?u.redIsOdd()!==r&&u.redINeg():1!==u.redJacobi()&&u.redINeg(),1!==u.redJacobi())throw new Error("Invalid `a` coefficient.");var a=o.redMul(u),h=e.redMul(o),l=t.redMul(a);return H(h.eq(d)),[h,l]}}]),f}(I),N=function(t){n(r,t);var f=c(r);function r(e,t,i){var n;return u(this,r),H(e instanceof g),(n=f.call(this,e,y)).x=n.curve.zero,n.y=n.curve.zero,n.inf=!0,null!=t&&n._init(t,i),n}return a(r,[{key:"_init",value:function(e,t){H(e instanceof b),H(t instanceof b),this.x=e,this.y=t,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1}},{key:"_getBeta",value:function(){var e=this;if(!this.curve.endo)return null;if(this.pre&&this.pre.beta)return this.pre.beta;var t=this.x.redMul(this.curve.endo.beta),f=this.curve.point(t,this.y);return this.pre&&(f.pre=this.pre.map((function(t){var f=t.x.redMul(e.curve.endo.beta);return e.curve.point(f,t.y)})),this.pre.beta=f),f}},{key:"_getJNAF",value:function(e){if(H(e instanceof r),this.inf||e.inf)return i(d(r.prototype),"_getJNAF",this).call(this,e);var t=[this,null,null,e];return this.y.eq(e.y)?(t[1]=this.add(e),t[2]=this.toJ().sub(e)):this.y.eq(e.y.redNeg())?(t[1]=this.toJ().add(e),t[2]=this.sub(e)):(t[1]=this.toJ().add(e),t[2]=this.toJ().sub(e)),t}},{key:"clone",value:function(){return this.inf?this.curve.point():this.curve.point(this.x,this.y)}},{key:"scale",value:function(e){return this.toJ().scale(e)}},{key:"neg",value:function(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}},{key:"add",value:function(e){if(H(e instanceof r),this.inf)return e;if(e.inf)return this;if(this.x.eq(e.x))return this.y.eq(e.y)?this.dbl():this.curve.point();if(this.y.eq(e.y)){var t=this.x.redNeg().redISub(e.x),f=this.y.redNeg();return this.curve.point(t,f)}var i=this.x.redSub(e.x),n=this.y.redSub(e.y).redDiv(i),s=n.redSqr().redISub(this.x).redISub(e.x),d=n.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,d)}},{key:"dbl",value:function(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();var e=this.x.redSqr().redIMuln(3).redIAdd(this.curve.a),t=this.y.redMuln(2),f=e.redDiv(t),r=f.redSqr().redISub(this.x).redISub(this.x),i=f.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)}},{key:"dblp",value:function(e){return this.toJ().dblp(e).toP()}},{key:"getX",value:function(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}},{key:"getY",value:function(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}},{key:"eq",value:function(e){return H(e instanceof r),this===e||(this.inf?e.inf:!e.inf&&(this.x.eq(e.x)&&this.y.eq(e.y)))}},{key:"cmp",value:function(e){return H(e instanceof r),this.inf&&!e.inf?-1:!this.inf&&e.inf?1:this.inf&&e.inf?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}},{key:"isInfinity",value:function(){return this.inf}},{key:"isOrder2",value:function(){return!this.inf&&this.y.isZero()}},{key:"isOdd",value:function(){return!this.inf&&this.y.redIsOdd()}},{key:"isEven",value:function(){return!this.inf&&this.y.redIsEven()}},{key:"isSquare",value:function(){return!this.inf&&-1!==this.y.redJacobi()}},{key:"eqX",value:function(e){return H(e instanceof b),H(!e.red),!this.inf&&this.getX().eq(e)}},{key:"eqR",value:function(e){return H(e instanceof b),H(!e.red),H(!this.curve.n.isZero()),!this.inf&&this.getX().imod(this.curve.n).eq(e)}},{key:"mul",value:function(e){return i(d(r.prototype),"mul",this).call(this,e).toP()}},{key:"muln",value:function(e){return i(d(r.prototype),"muln",this).call(this,e).toP()}},{key:"mulBlind",value:function(e,t){return i(d(r.prototype),"mulBlind",this).call(this,e,t).toP()}},{key:"mulAdd",value:function(e,t,f){return i(d(r.prototype),"mulAdd",this).call(this,e,t,f).toP()}},{key:"mulH",value:function(){return i(d(r.prototype),"mulH",this).call(this).toP()}},{key:"div",value:function(e){return i(d(r.prototype),"div",this).call(this,e).toP()}},{key:"divn",value:function(e){return i(d(r.prototype),"divn",this).call(this,e).toP()}},{key:"divH",value:function(){return i(d(r.prototype),"divH",this).call(this).toP()}},{key:"toP",value:function(){return this}},{key:"toJ",value:function(){return this.inf?this.curve.jpoint():this.curve.jpoint(this.x,this.y,this.curve.one)}},{key:"encode",value:function(t){null==t&&(t=!0),H("boolean"==typeof t);var f=this.curve.fieldSize;if(this.inf)throw new Error("Invalid point.");if(t){var r=e.alloc(1+f),i=this.curve.encodeField(this.getX());return r[0]=2|this.y.redIsOdd(),i.copy(r,1),r}var n=e.alloc(1+2*f),s=this.curve.encodeField(this.getX()),d=this.curve.encodeField(this.getY());return n[0]=4,s.copy(n,1),d.copy(n,1+f),n}},{key:"encodeX",value:function(){return this.curve.encodeField(this.getX())}},{key:"toJSON",value:function(e){if(this.inf)return[];var t=this.getX().toJSON(),f=this.getY().toJSON();return!0===e&&this.pre?[t,f,this.pre.toJSON()]:[t,f]}},{key:"toPretty",value:function(){if(this.inf)return[];var e=2*this.curve.fieldSize;return[K(this.getX(),e),K(this.getY(),e)]}},{key:v,value:function(){return this.inf?"<ShortPoint: Infinity>":"<ShortPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}],[{key:"decode",value:function(t,f){H(t instanceof g),H(e.isBuffer(f));var r=t.fieldSize;if(f.length<1+r)throw new Error("Not a point.");var i=f[0];switch(i){case 2:case 3:if(f.length!==1+r)throw new Error("Invalid point size for compressed.");var n=t.decodeField(f.slice(1,1+r));if(n.cmp(t.p)>=0)throw new Error("Invalid point.");var s=t.pointFromX(n,3===i);return H(!s.isInfinity()),s;case 4:case 6:case 7:if(f.length!==1+2*r)throw new Error("Invalid point size for uncompressed.");var d=t.decodeField(f.slice(1,1+r)),o=t.decodeField(f.slice(1+r,1+2*r));if(d.cmp(t.p)>=0||o.cmp(t.p)>=0)throw new Error("Invalid point.");if(4!==i&&i!==(6|o.isOdd()))throw new Error("Invalid hybrid encoding.");var u=t.point(d,o);if(!u.validate())throw new Error("Invalid point.");return H(!u.isInfinity()),u;default:throw new Error("Unknown point format.")}}},{key:"decodeEven",value:function(e,t){H(e instanceof g);var f=e.decodeField(t);if(f.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromX(f,!1)}},{key:"decodeSquare",value:function(e,t){H(e instanceof g);var f=e.decodeField(t);if(f.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromX(f)}},{key:"fromJSON",value:function(e,t){if(H(e instanceof g),H(Array.isArray(t)),H(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();var f=b.fromJSON(t[0]),r=b.fromJSON(t[1]),i=e.point(f,r);return t.length>2&&null!=t[2]&&(i.pre=E.fromJSON(i,t[2])),i}}]),r}(M),z=function(e){n(f,e);var t=c(f);function f(e,r,i,n){var s;return u(this,f),H(e instanceof g),(s=t.call(this,e,p)).x=s.curve.one,s.y=s.curve.one,s.z=s.curve.zero,s.zOne=!1,null!=r&&s._init(r,i,n),s}return a(f,[{key:"_init",value:function(e,t,f){H(e instanceof b),H(t instanceof b),H(null==f||f instanceof b),this.x=e,this.y=t,this.z=f||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z.eq(this.curve.one)}},{key:"clone",value:function(){return this.curve.jpoint(this.x,this.y,this.z)}},{key:"validate",value:function(){var e=this.curve,t=e.a,f=e.b;if(this.isInfinity())return!0;if(this.zOne)return this.curve.validate(this.toP());var r=this.y.redSqr(),i=this.x.redSqr().redMul(this.x),n=this.z.redSqr(),s=n.redSqr(),d=s.redMul(n),o=i.redIAdd(f.redMul(d));return this.curve.zeroA||(this.curve.threeA?o.redIAdd(s.redIMuln(-3).redMul(this.x)):o.redIAdd(t.redMul(s).redMul(this.x))),r.eq(o)}},{key:"normalize",value:function(){if(this.zOne)return this;if(this.isInfinity())return this;var e=this.z.redInvert(),t=e.redSqr();return this.x=this.x.redMul(t),this.y=this.y.redMul(t).redMul(e),this.z=this.curve.one,this.zOne=!0,this}},{key:"scale",value:function(e){if(H(e instanceof b),this.isInfinity())return this.curve.jpoint();var t=e.redSqr(),f=this.x.redMul(t),r=this.y.redMul(t).redMul(e),i=this.z.redMul(e);return this.curve.jpoint(f,r,i)}},{key:"neg",value:function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)}},{key:"add",value:function(e){return H(e instanceof M),e.type===y?this._mixedAdd(e):this._add(e)}},{key:"_add",value:function(e){return H(e instanceof f),this.isInfinity()?e:e.isInfinity()?this:this.zOne?e._addJA(this):e.zOne?this._addJA(e):this._addJJ(e)}},{key:"_mixedAdd",value:function(e){return H(e instanceof N),this.isInfinity()?e.toJ():e.isInfinity()?this:this._addJA(e)}},{key:"_addJJ",value:function(e){var t=this.z.redSqr(),f=e.z.redSqr(),r=this.x.redMul(f),i=e.x.redMul(t),n=this.y.redMul(e.z).redMul(f),s=e.y.redMul(this.z).redMul(t),d=i.redISub(r),o=s.redISub(n);if(d.isZero())return o.isZero()?this.dbl():this.curve.jpoint();var u=d.redSqr(),a=d.redMul(u),h=r.redMul(u),l=o.redSqr().redISub(a).redISub(h).redISub(h),c=o.redMul(h.redISub(l)).redISub(n.redMul(a)),v=this.z.redMul(e.z).redMul(d);return this.curve.jpoint(l,c,v)}},{key:"_addJA",value:function(e){var t=this.z.redSqr(),f=e.x.redMul(t),r=e.y.redMul(this.z).redMul(t),i=f.redISub(this.x),n=r.redISub(this.y).redIMuln(2);if(i.isZero())return n.isZero()?this.dbl():this.curve.jpoint();var s=i.redMuln(2).redSqr(),d=i.redMul(s),o=this.x.redMul(s),u=n.redSqr().redISub(d).redISub(o).redISub(o),a=n.redMul(o.redISub(u)).redISub(this.y.redMul(d).redIMuln(2)),h=this.z.redMul(i).redIMuln(2);return this.curve.jpoint(u,a,h)}},{key:"dbl",value:function(){return this.isInfinity()?this:this.y.isZero()?this.curve.jpoint():this.curve.zeroA?this._dbl0():this.curve.threeA?this._dbl3():this._dblJ()}},{key:"_dblJ",value:function(){var e=this.x.redSqr(),t=this.y.redSqr(),f=this.z.redSqr(),r=this.x.redMul(t).redIMuln(4),i=e.redIMuln(3).redIAdd(this.curve.a.redMul(f.redSqr())),n=i.redSqr().redISub(r).redISub(r),s=n,d=i.redMul(r.redISub(n)).redISub(t.redSqr().redIMuln(8)),o=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(s,d,o)}},{key:"_dbl0",value:function(){var e=this.x.redSqr(),t=this.y.redSqr(),f=t.redSqr(),r=t.redIAdd(this.x).redSqr().redISub(e).redISub(f).redIMuln(2),i=e.redIMuln(3),n=i.redSqr().redISub(r).redISub(r),s=i.redMul(r.redISub(n)).redISub(f.redIMuln(8)),d=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(n,s,d)}},{key:"_dbl3",value:function(){var e=this.z.redSqr(),t=this.y.redSqr(),f=this.x.redMul(t),r=this.x.redSub(e),i=this.x.redAdd(e),n=r.redMul(i).redIMuln(3),s=f.redIMuln(4),d=s.redMuln(2),o=t.redSqr().redIMuln(8),u=n.redSqr().redISub(d),a=this.y.redAdd(this.z).redSqr().redISub(t).redISub(e),h=n.redMul(s.redISub(u)).redISub(o);return this.curve.jpoint(u,h,a)}},{key:"getX",value:function(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}},{key:"getY",value:function(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.y.fromRed()}},{key:"eq",value:function(e){if(H(e instanceof f),this===e)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return!1;if(this.z.eq(e.z))return this.x.eq(e.x)&&this.y.eq(e.y);var t=this.z.redSqr(),r=e.z.redSqr(),i=this.x.redMul(r),n=e.x.redMul(t);if(!i.eq(n))return!1;var s=t.redMul(this.z),d=r.redMul(e.z),o=this.y.redMul(d),u=e.y.redMul(s);return o.eq(u)}},{key:"cmp",value:function(e){H(e instanceof f);var t=this.isInfinity(),r=e.isInfinity();return t&&!r?-1:!t&&r?1:t&&r?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}},{key:"isInfinity",value:function(){return this.z.isZero()}},{key:"isOrder2",value:function(){return!this.isInfinity()&&this.y.isZero()}},{key:"isOdd",value:function(){return!this.isInfinity()&&(this.normalize(),this.y.redIsOdd())}},{key:"isEven",value:function(){return!this.isInfinity()&&(this.normalize(),this.y.redIsEven())}},{key:"isSquare",value:function(){return!this.isInfinity()&&-1!==this.y.redMul(this.z).redJacobi()}},{key:"eqX",value:function(e){if(H(e instanceof b),H(!e.red),this.isInfinity())return!1;var t=this.z.redSqr(),f=e.toRed(this.curve.red).redMul(t);return this.x.eq(f)}},{key:"eqR",value:function(e){if(H(e instanceof b),H(!e.red),!this.curve.smallGap)return this.toP().eqR(e);if(this.isInfinity())return!1;if(e.cmp(this.curve.p)>=0)return!1;var t=this.z.redSqr(),f=e.toRed(this.curve.red).redMul(t);if(this.x.eq(f))return!0;if(this.curve.highOrder)return!1;if(e.cmp(this.curve.pmodn)>=0)return!1;var r=this.curve.redN.redMul(t);return f.redIAdd(r),this.x.eq(f)}},{key:"toP",value:function(){return this.isInfinity()?this.curve.point():(this.normalize(),this.curve.point(this.x,this.y))}},{key:"toJ",value:function(){return this}},{key:"encode",value:function(e){return this.toP().encode(e)}},{key:"encodeX",value:function(){return this.toP().encodeX()}},{key:"toJSON",value:function(e){return this.toP().toJSON(e)}},{key:"toPretty",value:function(){return this.toP().toPretty()}},{key:v,value:function(){return this.isInfinity()?"<JPoint: Infinity>":"<JPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}],[{key:"decode",value:function(e,t){return N.decode(e,t).toJ()}},{key:"decodeEven",value:function(e,t){return N.decodeEven(e,t).toJ()}},{key:"decodeSquare",value:function(e,t){return N.decodeSquare(e,t).toJ()}},{key:"fromJSON",value:function(e,t){return N.fromJSON(e,t).toJ()}}]),f}(M),q=function(e){n(f,e);var t=c(f);function f(e){var r;return u(this,f),(r=t.call(this,A,"mont",e)).a=b.fromJSON(e.a).toRed(r.red),r.b=b.fromJSON(e.b).toRed(r.red),r.bi=r.b.redInvert(),r.a2=r.a.redAdd(r.two),r.a24=r.a2.redMul(r.i4),r.a3=r.a.redMul(r.i3),r.a0=r.a.redMul(r.bi),r.b0=r.bi.redSqr(),r._finalize(e),r}return a(f,[{key:"_short",value:function(e,t){var f=this.a,r=this.b,i=this.three,n=f.redSqr(),s=n.redMul(f),d=r.redSqr(),o=d.redMul(r),u=i.redSub(n),a=d.redMuln(3),h=s.redMuln(2).redISub(f.redMuln(9)),l=o.redMuln(27),c=u.redDiv(a),v=h.redDiv(l);return null!=e?g._isomorphism(c,v,e,t):[c,v]}},{key:"_mont",value:function(e){return f._isomorphism(this.a,this.b,e)}},{key:"_edwards",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];H("boolean"==typeof t);var f=this.two,r=this.bi,i=this.a.redAdd(f).redMul(r),n=this.a.redSub(f).redMul(r);return t&&i.swap(n),null!=e?x._isomorphism(i,n,e):[i,n]}},{key:"_scaleShort",value:function(e){H(e instanceof g);var t=e._scale(this),f=o(t,2),r=f[0],i=f[1];return[this.field(r.redInvert()),this.field(i.redInvert())]}},{key:"_scaleMont",value:function(e){return H(e instanceof f),this.g.isInfinity()||e.g.isInfinity()?this.field(e.b).redDivSqrt(this.b):this.g.y.redDiv(this.field(e.g.y))}},{key:"_scaleEdwards",value:function(e,t){H(e instanceof x);var f=e._scale(this,t);return this.field(f)}},{key:"_solveY0",value:function(e){H(e instanceof b);var t=this.a0,f=this.b0,r=e.redSqr();return r.redMul(e).redIAdd(t.redMul(r)).redIAdd(f.redMul(e))}},{key:"_elligator2",value:function(e){var t=this.a0.redNeg(),f=this.one.redAdd(this.z.redMul(e.redSqr()));f.isZero()&&f.inject(this.one);var r=t.redMul(f.redInvert()),i=r.redNeg().redISub(this.a0),n=this._solveY0(r),s=this._solveY0(i),d=0|n.redIsSquare(),o=[r,i][1^d],u=[n,s][1^d].redSqrt();u.redIsOdd()!==e.redIsOdd()&&u.redINeg();var a=this.b.redMul(o),h=this.b.redMul(u);return this.point(a,h)}},{key:"_invert2",value:function(e,t){var f=e.x,r=e.y,i=1&t,n=f.redMul(this.bi),s=r.redMul(this.bi),d=n.redAdd(this.a0),o=n,u=[d,o][i].redINeg(),a=[o,d][i].redMul(this.z),h=u.redDivSqrt(a);return h.redIsOdd()!==s.redIsOdd()&&h.redINeg(),h}},{key:"isElliptic",value:function(){var e=this.a.redSqr();return!this.b.redMul(e.redSub(this.four)).isZero()}},{key:"jinv",value:function(){var e=this.a,t=this.three,f=this.four,r=e.redSqr(),i=r.redSub(t).redPown(3).redIMuln(256),n=r.redSub(f);if(n.isZero())throw new Error("Curve is not elliptic.");return i.redDiv(n).fromRed()}},{key:"point",value:function(e,t){return new A(this,e,t)}},{key:"jpoint",value:function(e,t,f){return H(null==e&&null==t&&null==f),this.point()}},{key:"xpoint",value:function(e,t){return new _(this,e,t)}},{key:"solveY2",value:function(e){H(e instanceof b);var t=e.redSqr();return t.redMul(e).redIAdd(this.a.redMul(t)).redIAdd(e).redMul(this.bi)}},{key:"validate",value:function(e){if(H(e instanceof A),e.isInfinity())return!0;var t=e.x,f=e.y,r=this.solveY2(t);return f.redSqr().eq(r)}},{key:"pointFromX",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;H(e instanceof b),H(null==t||"boolean"==typeof t),e.red||(e=e.toRed(this.red));var f=this.solveY(e);if(null!=t){if(f.isZero()&&t)throw new Error("Invalid point.");f.redIsOdd()!==t&&f.redINeg()}return this.point(e,f)}},{key:"isIsomorphic",value:function(e,t){if(H(e instanceof I),!e.p.eq(this.p))return!1;if("mont"===e.type){var f=this.field(e.a),r=this.field(e.b);return!!this.a.eq(f)&&(!this.b.isZero()&&1===r.redDiv(this.b).redJacobi())}return e.isIsomorphic(this,t)}},{key:"isIsogenous",value:function(e){return H(e instanceof I),"mont"!==e.type&&e.isIsogenous(this)}},{key:"pointFromShort",value:function(e){if(H(e instanceof N),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();var t=this.a3,f=this.b,r=this._scale(e.curve),i=o(r,2),n=i[0],s=i[1],d=this.field(e.x).redMul(n),u=this.field(e.y).redMul(s),a=f.redMul(d).redISub(t),h=f.redMul(u);return this.point(a,h)}throw new Error("Not implemented.")}},{key:"pointFromMont",value:function(e){if(H(e instanceof A),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();var t=this._scale(e.curve),f=this.field(e.x),r=this.field(e.y),i=f,n=t.redMul(r);return this.point(i,n)}throw new Error("Not implemented.")}},{key:"pointFromEdwards",value:function(e){H(e instanceof O),H(e.curve.p.eq(this.p));var t=this.field(e.x),f=this.field(e.y),r=this.field(e.z);if(this.isIsogenous(e.curve)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);var i=r.redSqr().redIMuln(2),n=f.redSqr(),s=t.redSqr(),d=i.redISub(s).redISub(n).redMul(f),o=s.redMul(t);return this.cpoint(n,s,d,o)}if(this.isIsomorphic(e.curve,!0)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);var u=this._scale(e.curve,!0),a=f.redAdd(r),h=f.redSub(r),l=u.redMul(r).redMul(a),c=t.redMul(h);return this.cpoint(a,h,l,c)}if(this.isIsomorphic(e.curve,!1)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);var v=this._scale(e.curve,!1),b=r.redAdd(f),y=r.redSub(f),p=v.redMul(r).redMul(b),m=t.redMul(y);return this.cpoint(b,y,p,m)}throw new Error("Not implemented.")}},{key:"pointFromUniform",value:function(e){if(H(e instanceof b),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");return this._elligator2(e)}},{key:"pointToUniform",value:function(e,t){var f=this;if(H(e instanceof A),H(t>>>0===t),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");if(e.isInfinity())throw new Error("Invalid point.");var r=(t>>>4&15)%this.torsion.length,i=e.add(this.torsion[r]);return L((function(){return f._invert2(i,t)}))}},{key:"decodePoint",value:function(e,t){return A.decode(this,e,t)}},{key:"encodeX",value:function(e){return H(e instanceof _),e.encode()}},{key:"decodeX",value:function(e){return _.decode(this,e)}},{key:"toShort",value:function(e,t){var f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this._short(e,t),i=o(r,2),n=i[0],s=i[1],d=new g({red:this.red,prime:this.prime,p:this.p,a:n,b:s,n:this.n,h:this.h});if(null!=f){var u=d._scale(this),a=o(u,2),h=a[1];h.redIsOdd()!==f&&h.redINeg()}this.g.isInfinity()||(d.g=d.pointFromMont(this.g));for(var l=0;l<this.h.word(0);l++)d.torsion[l]=d.pointFromMont(this.torsion[l]);return d}},{key:"toMont",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._mont(e),i=o(r,2),n=i[0],s=i[1],d=new f({red:this.red,prime:this.prime,p:this.p,a:n,b:s,n:this.n,h:this.h,z:this.z});if(null!=t){var u=d._scale(this);u.redIsOdd()!==t&&u.redINeg()}this.g.isInfinity()||(d.g=d.pointFromMont(this.g));for(var a=0;a<this.h.word(0);a++)d.torsion[a]=d.pointFromMont(this.torsion[a]);return d}},{key:"toEdwards",value:function(e,t){var f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this._edwards(e,t),i=o(r,2),n=i[0],s=i[1],d=new x({red:this.red,prime:this.prime,p:this.p,a:n,d:s,n:this.n,h:this.h,z:this.z});if(null!=f){var u=d._scale(this,t);u.redIsOdd()!==f&&u.redINeg()}if(this.g.isInfinity()||(d.g=d.pointFromMont(this.g),d.g.normalize()),d.isComplete())for(var a=0;a<this.h.word(0);a++)d.torsion[a]=d.pointFromMont(this.torsion[a]),d.torsion[a].normalize();return d}},{key:"pointFromJSON",value:function(e){return A.fromJSON(this,e)}},{key:"toJSON",value:function(e){var t=i(d(f.prototype),"toJSON",this).call(this,e);return t.a=this.a.fromRed().toJSON(),t.b=this.b.fromRed().toJSON(),t}}],[{key:"_isomorphism",value:function(e,t,f){H(e instanceof b),H(t instanceof b),H(f instanceof b);var r=e.clone(),i=f.clone();if(1!==t.redDiv(f).redJacobi())throw new Error("Invalid `b` coefficient.");return[r,i]}}]),f}(I),A=function(e){n(f,e);var t=c(f);function f(e,r,i){var n;return u(this,f),H(e instanceof q),(n=t.call(this,e,y)).x=n.curve.zero,n.y=n.curve.zero,n.inf=!0,null!=r&&n._init(r,i),n}return a(f,[{key:"_init",value:function(e,t){H(e instanceof b),H(t instanceof b),this.x=e,this.y=t,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1}},{key:"clone",value:function(){return this.inf?this.curve.point():this.curve.point(this.x,this.y)}},{key:"scale",value:function(e){return this.clone()}},{key:"randomize",value:function(e){return this.clone()}},{key:"neg",value:function(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}},{key:"add",value:function(e){if(H(e instanceof f),this.inf)return e;if(e.inf)return this;if(this.x.eq(e.x))return this.y.eq(e.y)?this.dbl():this.curve.point();var t=e.x.redSub(this.x),r=e.y.redSub(this.y).redDiv(t),i=this.curve.b.redMul(r.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)}},{key:"dbl",value:function(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();var e=this.x.redSqr().redIMuln(3),t=this.curve.a.redMul(this.x).redIMuln(2),f=e.redIAdd(t).redIAdd(this.curve.one),r=this.curve.b.redMul(this.y).redIMuln(2),i=f.redDiv(r),n=this.curve.b.redMul(i.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(this.x),s=i.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,s)}},{key:"getX",value:function(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}},{key:"getY",value:function(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}},{key:"eq",value:function(e){return H(e instanceof f),this===e||(this.inf?e.inf:!e.inf&&(this.x.eq(e.x)&&this.y.eq(e.y)))}},{key:"cmp",value:function(e){return H(e instanceof f),this.inf&&!e.inf?-1:!this.inf&&e.inf?1:this.inf&&e.inf?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}},{key:"isInfinity",value:function(){return this.inf}},{key:"isOrder2",value:function(){return!this.inf&&this.y.isZero()}},{key:"isOdd",value:function(){return!this.inf&&this.y.redIsOdd()}},{key:"isEven",value:function(){return!this.inf&&this.y.redIsEven()}},{key:"toP",value:function(){return this}},{key:"toJ",value:function(){return this}},{key:"toX",value:function(){return this.inf?this.curve.xpoint():this.curve.xpoint(this.x,this.curve.one)}},{key:"encode",value:function(){return this.toX().encode()}},{key:"toJSON",value:function(e){return this.inf?[]:[this.getX().toJSON(),this.getY().toJSON()]}},{key:"toPretty",value:function(){if(this.inf)return[];var e=2*this.curve.fieldSize;return[K(this.getX(),e),K(this.getY(),e)]}},{key:v,value:function(){return this.inf?"<MontPoint: Infinity>":"<MontPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}],[{key:"decode",value:function(e,t,f){return H(e instanceof q),e.decodeX(t).toP(f)}},{key:"fromJSON",value:function(e,t){if(H(e instanceof q),H(Array.isArray(t)),H(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();var f=b.fromJSON(t[0]),r=b.fromJSON(t[1]);return e.point(f,r)}}]),f}(M),_=function(e){n(f,e);var t=c(f);function f(e,r,i){var n;return u(this,f),H(e instanceof q),(n=t.call(this,e,m)).x=n.curve.one,n.z=n.curve.zero,null!=r&&n._init(r,i),n}return a(f,[{key:"_init",value:function(e,t){H(e instanceof b),H(null==t||t instanceof b),this.x=e,this.z=t||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red))}},{key:"clone",value:function(){return this.curve.xpoint(this.x,this.z)}},{key:"precompute",value:function(e,t){return this}},{key:"validate",value:function(){if(this.isInfinity())return!0;var e=this.x,t=this.z,f=e.redSqr(),r=f.redMul(e),i=t.redSqr(),n=this.curve.a.redMul(f).redMul(t);return-1!==r.redIAdd(n).redIAdd(e.redMul(i)).redMul(this.curve.bi).redMul(t).redJacobi()}},{key:"normalize",value:function(){return this.isInfinity()||this.z.eq(this.curve.one)||(this.x=this.x.redDiv(this.z),this.z=this.curve.one),this}},{key:"scale",value:function(e){if(H(e instanceof b),this.isInfinity())return this.curve.xpoint();var t=this.x.redMul(e),f=this.z.redMul(e);return this.curve.xpoint(t,f)}},{key:"neg",value:function(){return this}},{key:"dbl",value:function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),f=e.redSub(t),r=e.redMul(t),i=f.redMul(t.redIAdd(this.curve.a24.redMul(f)));return this.curve.xpoint(r,i)}},{key:"diffAddDbl",value:function(e,t){H(e instanceof f),H(t instanceof f);var r=e.x.redAdd(e.z),i=r.redSqr(),n=e.x.redSub(e.z),s=n.redSqr(),d=i.redSub(s),o=t.x.redAdd(t.z),u=t.x.redSub(t.z).redMul(r),a=o.redMul(n),h=this.z.redMul(u.redAdd(a).redSqr()),l=this.x.redMul(u.redISub(a).redSqr()),c=i.redMul(s),v=d.redMul(s.redIAdd(this.curve.a24.redMul(d)));return[this.curve.xpoint(c,v),this.curve.xpoint(h,l)]}},{key:"getX",value:function(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}},{key:"getY",value:function(e){return this.toP(e).getY()}},{key:"eq",value:function(e){if(H(e instanceof f),this===e)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return!1;if(this.z.eq(e.z))return this.x.eq(e.x);var t=this.x.redMul(e.z),r=e.x.redMul(this.z);return t.eq(r)}},{key:"cmp",value:function(e){H(e instanceof f);var t=this.isInfinity(),r=e.isInfinity();return t&&!r?-1:!t&&r?1:t&&r?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())}},{key:"isInfinity",value:function(){return this.z.isZero()}},{key:"isOrder2",value:function(){return!this.isInfinity()&&this.x.isZero()}},{key:"isOdd",value:function(){return!1}},{key:"isEven",value:function(){return!1}},{key:"hasTorsion",value:function(){return!this.isInfinity()&&(!!this.x.isZero()||i(d(f.prototype),"hasTorsion",this).call(this))}},{key:"order",value:function(){try{return this.toP().order()}catch(e){return new b(1)}}},{key:"jmul",value:function(e){H(e instanceof b),H(!e.red);for(var t=e.bitLength(),f=this.curve.xpoint(),r=this,i=t-1;i>=0;i--){if(0===e.bit(i)){var n=this.diffAddDbl(f,r),s=o(n,2);f=s[0],r=s[1]}else{var d=this.diffAddDbl(r,f),u=o(d,2);r=u[0],f=u[1]}}return f}},{key:"jmulBlind",value:function(e,t){return t?this.randomize(t).jmul(e):this.jmul(e)}},{key:"jmulAdd",value:function(e,t,f){throw new Error("Not implemented.")}},{key:"toP",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return H(null==e||"boolean"==typeof e),this.isInfinity()?this.curve.point():(this.normalize(),this.curve.pointFromX(this.x,e))}},{key:"toJ",value:function(){return this}},{key:"toX",value:function(){return this}},{key:"key",value:function(){if(this.isInfinity())return"".concat(this.curve.uid,":oo");this.normalize();var e=this.getX().toString(16);return"".concat(this.curve.uid,":").concat(e)}},{key:"encode",value:function(){return this.curve.encodeField(this.getX())}},{key:"toJSON",value:function(e){return this.toP().toJSON(e)}},{key:"toPretty",value:function(){return this.toP().toPretty()}},{key:v,value:function(){return this.isInfinity()?"<XPoint: Infinity>":"<XPoint: x="+this.x.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}],[{key:"decode",value:function(e,t){H(e instanceof q);var f=e.decodeField(t);f.iumaskn(e.fieldBits);var r=e.xpoint(f,e.one);return H(!r.isInfinity()),r}},{key:"fromJSON",value:function(e,t){return A.fromJSON(e,t).toX()}}]),f}(M),x=function(e){n(f,e);var t=c(f);function f(e){var r;return u(this,f),(r=t.call(this,O,"edwards",e)).a=b.fromJSON(e.a).toRed(r.red),r.d=b.fromJSON(e.d).toRed(r.red),r.s=b.fromJSON(e.s||"0").toRed(r.red),r.si=r.s.isZero()?r.zero:r.s.redInvert(),r.k=r.d.redMuln(2),r.smi=-r.d.redNeg().word(0),r.ad6=r.a.redAdd(r.d).redMul(r.i6),r.twisted=!r.a.eq(r.one),r.oneA=r.a.eq(r.one),r.mOneA=r.a.eq(r.one.redNeg()),r.smallD=null!=r.prime&&1===r.d.redNeg().length,r.alt=null,r._finalize(e),r}return a(f,[{key:"_short",value:function(e,t){var f=this.a,r=this.d,i=f.redSqr(),n=i.redMul(f),s=r.redSqr(),d=s.redMul(r),o=f.redMul(r).redIMuln(14),u=i.redMul(r),a=f.redMul(s),h=u.redIAdd(a).redIMuln(33),l=i.redAdd(o).redIAdd(s).redDivn(-48),c=h.redISub(n).redISub(d).redDivn(864);return null!=e?g._isomorphism(l,c,e,t):[l,c]}},{key:"_mont",value:function(e){var t,f,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];H("boolean"==typeof r),r?(t=this.d.redAdd(this.a),f=this.d.redSub(this.a)):(t=this.a.redAdd(this.d),f=this.a.redSub(this.d));var i=f.redInvert(),n=t.redMuln(2).redMul(i),s=i.redMuln(4);return null!=e?q._isomorphism(n,s,e):[n,s]}},{key:"_edwards",value:function(e){return f._isomorphism(this.a,this.d,e)}},{key:"_scaleShort",value:function(e){H(e instanceof g);var t=e._scale(this),f=o(t,2),r=f[0],i=f[1];return[this.field(r.redInvert()),this.field(i.redInvert())]}},{key:"_scaleMont",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(H(e instanceof q),H("boolean"==typeof t),this.g.isInfinity()||e.g.isInfinity()){var f=e._edwards(null,t),r=o(f,1),i=r[0];return this.field(i).redDivSqrt(this.a)}var n=e.g.x.redDiv(e.g.y);return this.g.x.redDiv(this.field(n))}},{key:"_scaleEdwards",value:function(e){return H(e instanceof f),this.g.isInfinity()||e.g.isInfinity()?this.field(e.a).redDivSqrt(this.a):this.g.x.redDiv(this.field(e.g.x))}},{key:"_mulA",value:function(e){return H(e instanceof b),this.oneA?e.clone():this.mOneA?e.redNeg():this.a.redMul(e)}},{key:"_mulD",value:function(e){return H(e instanceof b),this.smallD?e.redMuln(this.smi):this.d.redMul(e)}},{key:"_elligator1",value:function(e){var t=this.s,f=this.si,r=this.i2,i=this.one,n=this.two,s=f.redSqr().redIMuln(2),d=t.redSqr().redMul(r),o=d.redSqr(),u=s.redAdd(d),a=u.redSqr().redISub(n),h=s.redSub(i),l=i.redSub(e),c=i.redAdd(e),v=c.isZero()?c:l.redDiv(c),b=v.redSqr(),y=b.redMul(v),p=y.redMul(b).redAdd(a.redMul(y)).redIAdd(v),m=this.field(p.redJacobi()),S=this.field(b.redAdd(o).redJacobi()),w=m.redMul(S),k=m.redMul(v),I=m.redMul(p).redSqrt().redMul(w),M=i.redAdd(k),g=u.redMul(k),N=M.redSqr(),z=h.redMul(t).redMul(k).redMul(M),q=v.isZero()?this.one:I,A=g.redSub(N),_=g.redAdd(N);return this.cpoint(z,q,A,_)}},{key:"_invert1",value:function(e,t){var f=this.s,r=this.si,i=this.i2,n=this.one,s=e.x,d=e.y,o=e.z,u=1&t,a=r.redSqr().redIMuln(2),h=f.redSqr().redMul(i),l=h.redSqr(),c=a.redAdd(h),v=a.redSub(n),b=d.redSub(o),y=d.redAdd(o).redIMuln(2),p=y.isZero()?y:b.redDiv(y),m=n.redAdd(p.redMul(c)),S=m.redSqr().redISub(n).redSqrt().redSub(m),w=n.redAdd(S),k=v.redMul(f).redMul(S).redMul(w).redMul(s.redMul(o)),I=S.redSqr().redIAdd(l),M=this.field(k.redMul(I).redJacobi()).redMul(S),g=n.redSub(M),N=n.redAdd(M),z=N.isZero()?N:g.redDiv(N);return z.redIsOdd()!==Boolean(u)&&z.redINeg(),z}},{key:"_alt",value:function(){return this.alt||(this.alt=this.toMont()),this.alt}},{key:"isElliptic",value:function(){var e=this.a.redMul(this.d),t=this.a.redSub(this.d);return!e.redMul(t).isZero()}},{key:"jinv",value:function(){var e=this.a,t=this.d,f=e.redMul(t),r=e.redSub(t).redPown(4),i=e.redSqr(),n=t.redSqr(),s=i.redAdd(f.redMuln(14)).redIAdd(n).redPown(3).redIMuln(16),d=f.redMul(r);if(d.isZero())throw new Error("Curve is not elliptic.");return s.redDiv(d).fromRed()}},{key:"isComplete",value:function(){return 1===this.a.redJacobi()&&-1===this.d.redJacobi()}},{key:"point",value:function(e,t,f,r){return new O(this,e,t,f,r)}},{key:"jpoint",value:function(e,t,f){return H(null==e&&null==t&&null==f),this.point()}},{key:"cpoint",value:function(e,t,f,r){H(e instanceof b),H(t instanceof b),H(f instanceof b),H(r instanceof b);var i=e.redMul(r),n=f.redMul(t),s=t.redMul(r),d=e.redMul(f);return this.point(i,n,s,d)}},{key:"solveX2",value:function(e){H(e instanceof b);var t=e.redSqr(),f=this._mulD(t).redISub(this.a);return t.redISub(this.one).redDiv(f)}},{key:"solveX",value:function(e){var t=e.redSqr(),f=this._mulD(t).redISub(this.a);return t.redISub(this.one).redDivSqrt(f)}},{key:"solveY2",value:function(e){H(e instanceof b);var t=e.redSqr(),f=this._mulA(t).redISub(this.one),r=this._mulD(t).redISub(this.one);return f.redDiv(r)}},{key:"solveY",value:function(e){var t=e.redSqr(),f=this._mulA(t).redISub(this.one),r=this._mulD(t).redISub(this.one);return f.redDivSqrt(r)}},{key:"validate",value:function(e){if(H(e instanceof O),e.zOne){var t=e.x.redSqr(),f=e.y.redSqr(),r=this._mulD(t).redMul(f),i=this._mulA(t).redIAdd(f),n=this.one.redAdd(r),s=e.t,d=e.x.redMul(e.y);return i.eq(n)&&s.eq(d)}var o=e.x.redSqr(),u=e.y.redSqr(),a=e.z.redSqr(),h=a.redSqr(),l=this._mulD(o).redMul(u),c=this._mulA(o).redIAdd(u).redMul(a),v=h.redIAdd(l),b=e.t.redMul(e.z),y=e.x.redMul(e.y);return c.eq(v)&&b.eq(y)}},{key:"pointFromX",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;H(e instanceof b),H(null==t||"boolean"==typeof t),e.red||(e=e.toRed(this.red));var f=this.solveY(e);if(null!=t){if(f.isZero()&&t)throw new Error("Invalid point.");f.redIsOdd()!==t&&f.redINeg()}return this.point(e,f)}},{key:"pointFromY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;H(e instanceof b),H(null==t||"boolean"==typeof t),e.red||(e=e.toRed(this.red));var f=this.solveX(e);if(null!=t){if(f.isZero()&&t)throw new Error("Invalid point.");f.redIsOdd()!==t&&f.redINeg()}return this.point(f,e)}},{key:"isIsomorphic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(H(e instanceof I),H("boolean"==typeof t),!e.p.eq(this.p))return!1;if("short"===e.type)return e.isIsomorphic(this);if("mont"===e.type){var f,r,i=this.field(e.a);return t?(f=this.d.redAdd(this.a),r=this.d.redSub(this.a)):(f=this.a.redAdd(this.d),r=this.a.redSub(this.d)),i.redMul(r).eq(f.redIMuln(2))}if("edwards"===e.type){var n=this.field(e.a),s=this.field(e.d);return this.a.redMul(s).eq(n.redMul(this.d))}return!1}},{key:"isIsogenous",value:function(e){if(H(e instanceof I),!e.p.eq(this.p))return!1;if("mont"===e.type){if(!this.a.eq(this.one))return!1;var t=this.field(e.a),f=this.field(e.b),r=this.two.redSub(this.d.redMuln(4));return t.eq(r)&&f.eq(this.one)}if("edwards"===e.type){var i=this.field(e.a),n=this.field(e.d);return i.eq(this.a.redNeg())&&n.eq(this.d.redSub(this.a))}return!1}},{key:"pointFromShort",value:function(e){if(H(e instanceof N),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();if(e.y.isZero())return this.point(this.zero,this.one.redNeg());var t=this.a,f=this.d,r=this._scale(e.curve),i=o(r,2),n=i[0],s=i[1],d=t.redMuln(5),u=f.redMuln(5),a=this.field(e.x).redMul(n),h=this.field(e.y).redMul(s),l=a.redMuln(6),c=a.redMuln(12),v=l.redSub(t).redISub(f),b=h.redMuln(6),y=c.redSub(d).redIAdd(f),p=c.redAdd(t).redISub(u);return this.cpoint(v,b,y,p)}throw new Error("Not implemented.")}},{key:"pointFromMont",value:function(e){H(e instanceof A),H(e.curve.p.eq(this.p));var t=this.field(e.x),f=this.field(e.y);if(this.isIsogenous(e.curve)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point();var r=t.redSqr(),i=r.redMul(t),n=i.redMul(t),s=n.redMul(t),d=f.redSqr(),o=f.redMuln(4),u=r.redSub(this.one),a=r.redMuln(2),h=d.redMuln(4),l=i.redIMuln(2),c=t.redMul(d).redIMuln(4),v=r.redMul(d).redIMuln(2),b=d.redIMuln(2),y=o.redMul(u),p=n.redISub(a).redIAdd(h).redIAdd(this.one),m=s.redSub(l).redISub(c).redIAdd(t).redINeg(),S=s.redISub(v).redISub(l).redISub(b).redIAdd(t);return this.cpoint(y,p,m,S).divn(4)}if(this.isIsomorphic(e.curve,!0)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.one.redNeg());var w=this._scale(e.curve,!0).redMul(t),k=f,I=t.redAdd(this.one),M=t.redSub(this.one);return this.cpoint(w,k,I,M)}if(this.isIsomorphic(e.curve,!1)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.one.redNeg());var g=this._scale(e.curve,!1).redMul(t),N=f,z=t.redSub(this.one),q=t.redAdd(this.one);return this.cpoint(g,N,z,q)}throw new Error("Not implemented.")}},{key:"pointFromEdwards",value:function(e){H(e instanceof O),H(e.curve.p.eq(this.p));var t=this.field(e.curve.a),f=this.field(e.x),r=this.field(e.y),i=this.field(e.z),n=this.field(e.t);if(this.isIsogenous(e.curve)){var s=f.redMul(r),d=f.redSqr(),o=r.redSqr(),u=i.redSqr(),a=t.redMul(d),h=s.redIMuln(2),l=o.redSub(a),c=o.redAdd(a),v=u.redIMuln(2).redISub(c),b=this.cpoint(h,l,c,v);return this.twisted?b:b.divn(4)}if(this.isIsomorphic(e.curve)){var y=this._scale(e.curve),p=y.redMul(f),m=r,S=i,w=y.redMul(n);return this.point(p,m,S,w)}throw new Error("Not implemented.")}},{key:"pointFromUniform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;H(e instanceof b),H(e.red===this.red),H(null==t||t instanceof q),t||(t=this._alt());var f=t.field(e),r=t.pointFromUniform(f);return this.pointFromMont(r)}},{key:"pointToUniform",value:function(e,t){var f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;H(e instanceof O),H(t>>>0===t),H(null==f||f instanceof q),f||(f=this._alt());var r=(t>>4&15)%this.torsion.length,i=e.add(this.torsion[r]),n=f.pointFromEdwards(i),s=f.pointToUniform(n,15&t);return this.field(s)}},{key:"pointFromHash",value:function(e,t){var f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;H(null==f||f instanceof q),f||(f=this._alt());var r=f.pointFromHash(e,t);return this.pointFromMont(r)}},{key:"pointToHash",value:function(e,t,f){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;H(e instanceof O),H(t>>>0===t),H(null==r||r instanceof q),r||(r=this._alt());var i=t%this.torsion.length,n=e.add(this.torsion[i]),s=r.pointFromEdwards(n);return r.pointToHash(s,0,f)}},{key:"decodePoint",value:function(e){return O.decode(this,e)}},{key:"toShort",value:function(e,t){var f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this._short(e,t),i=o(r,2),n=i[0],s=i[1],d=new g({red:this.red,prime:this.prime,p:this.p,a:n,b:s,n:this.n,h:this.h});if(null!=f){var u=d._scale(this),a=o(u,2),h=a[1];h.redIsOdd()!==f&&h.redINeg()}this.g.isInfinity()||(d.g=d.pointFromEdwards(this.g));for(var l=0;l<this.h.word(0);l++)d.torsion[l]=d.pointFromEdwards(this.torsion[l]);return d}},{key:"toMont",value:function(e,t){var f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this._mont(e,t),i=o(r,2),n=i[0],s=i[1],d=new q({red:this.red,prime:this.prime,p:this.p,a:n,b:s,n:this.n,h:this.h,z:this.z});if(null!=f){var u=this._scale(d,t);u.redIsOdd()!==f&&u.redINeg()}this.g.isInfinity()||(d.g=d.pointFromEdwards(this.g));for(var a=0;a<this.h.word(0);a++)d.torsion[a]=d.pointFromEdwards(this.torsion[a]);return d}},{key:"toEdwards",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._edwards(e),i=o(r,2),n=i[0],s=i[1],d=new f({red:this.red,prime:this.prime,p:this.p,a:n,d:s,n:this.n,h:this.h,z:this.z});if(null!=t){var u=d._scale(this);u.redIsOdd()!==t&&u.redINeg()}if(this.g.isInfinity()||(d.g=d.pointFromEdwards(this.g),d.g.normalize()),d.isComplete())for(var a=0;a<this.h.word(0);a++)d.torsion[a]=d.pointFromEdwards(this.torsion[a]),d.torsion[a].normalize();return d}},{key:"pointFromJSON",value:function(e){return O.fromJSON(this,e)}},{key:"toJSON",value:function(e){var t=i(d(f.prototype),"toJSON",this).call(this,e);return t.a=this.a.fromRed().toJSON(),t.d=this.d.fromRed().toJSON(),this.s.isZero()||(t.s=this.s.fromRed().toJSON()),t}}],[{key:"_isomorphism",value:function(e,t,f){H(e instanceof b),H(t instanceof b),H(f instanceof b);var r=f.clone(),i=f.redMul(t).redDiv(e);if(1!==e.redDiv(f).redJacobi())throw new Error("Invalid `a` coefficient.");return[r,i]}}]),f}(I),O=function(e){n(f,e);var t=c(f);function f(e,r,i,n,s){var d;return u(this,f),H(e instanceof x),(d=t.call(this,e,S)).x=d.curve.zero,d.y=d.curve.one,d.z=d.curve.one,d.t=d.curve.zero,d.zOne=!0,null!=r&&d._init(r,i,n,s),d}return a(f,[{key:"_init",value:function(e,t,f,r){H(e instanceof b),H(t instanceof b),H(null==f||f instanceof b),H(null==r||r instanceof b),this.x=e,this.y=t,this.z=f||this.curve.one,this.t=r||null,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z.eq(this.curve.one),this._check(),this.t||(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redDiv(this.z)))}},{key:"_check",value:function(){if(this.z.isZero())throw new Error("Invalid point.")}},{key:"clone",value:function(){return this.curve.point(this.x,this.y,this.z,this.t)}},{key:"normalize",value:function(){if(this.zOne)return this;var e=this.z.redInvert();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t=this.t.redMul(e),this.z=this.curve.one,this.zOne=!0,this}},{key:"scale",value:function(e){H(e instanceof b);var t=this.x.redMul(e),f=this.y.redMul(e),r=this.z.redMul(e),i=this.t.redMul(e);return this.curve.point(t,f,r,i)}},{key:"neg",value:function(){var e=this.x.redNeg(),t=this.y,f=this.z,r=this.t.redNeg();return this.curve.point(e,t,f,r)}},{key:"add",value:function(e){return H(e instanceof f),this.isInfinity()?e:e.isInfinity()?this:this.zOne?e._add(this):this._add(e)}},{key:"_add",value:function(e){return this.curve.mOneA?this._addM1(e):this._addA(e)}},{key:"_addM1",value:function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),f=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),r=this.t.redMul(this.curve.k).redMul(e.t),i=e.zOne?this.z.redAdd(this.z):this.z.redMul(e.z).redIMuln(2),n=f.redSub(t),s=i.redSub(r),d=i.redIAdd(r),o=f.redIAdd(t),u=n.redMul(s),a=d.redMul(o),h=n.redMul(o),l=s.redMul(d);return this.curve.point(u,a,l,h)}},{key:"_addA",value:function(e){var t=this.x.redMul(e.x),f=this.y.redMul(e.y),r=this.curve._mulD(this.t).redMul(e.t),i=e.zOne?this.z.clone():this.z.redMul(e.z),n=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(t).redISub(f),s=i.redSub(r),d=i.redIAdd(r),o=f.redISub(this.curve._mulA(t)),u=n.redMul(s),a=d.redMul(o),h=n.redMul(o),l=s.redMul(d);return this.curve.point(u,a,l,h)}},{key:"dbl",value:function(){return this.isInfinity()?this:this._dbl()}},{key:"_dbl",value:function(){var e=this.x.redSqr(),t=this.y.redSqr(),f=this.zOne?this.curve.two:this.z.redSqr().redIMuln(2),r=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),n=r.redAdd(t),s=n.redSub(f),d=r.redISub(t),o=i.redMul(s),u=n.redMul(d),a=i.redMul(d),h=s.redMul(n);return this.curve.point(o,u,h,a)}},{key:"getX",value:function(){return this.normalize(),this.x.fromRed()}},{key:"getY",value:function(){return this.normalize(),this.y.fromRed()}},{key:"eq",value:function(e){if(H(e instanceof f),H(!this.z.isZero()),H(!e.z.isZero()),this===e)return!0;if(this.z.eq(e.z))return this.x.eq(e.x)&&this.y.eq(e.y);var t=this.x.redMul(e.z),r=e.x.redMul(this.z);if(!t.eq(r))return!1;var i=this.y.redMul(e.z),n=e.y.redMul(this.z);return i.eq(n)}},{key:"cmp",value:function(e){return H(e instanceof f),this.order().cmp(e.order())||this.getY().cmp(e.getY())||this.getX().cmp(e.getX())}},{key:"isInfinity",value:function(){return H(!this.z.isZero()),!!this.x.isZero()&&this.y.eq(this.z)}},{key:"isOrder2",value:function(){return!this.isInfinity()&&this.x.isZero()}},{key:"isOdd",value:function(){return this.normalize(),this.x.redIsOdd()}},{key:"isEven",value:function(){return this.normalize(),this.x.redIsEven()}},{key:"toP",value:function(){return this.normalize()}},{key:"toJ",value:function(){return this}},{key:"encode",value:function(){var e=this.getY();return e.setn(this.curve.signBit,this.x.redIsOdd()),this.curve.encodeAdjusted(e)}},{key:"toJSON",value:function(e){if(this.isInfinity())return[];var t=this.getX().toJSON(),f=this.getY().toJSON();return!0===e&&this.pre?[t,f,this.pre.toJSON()]:[t,f]}},{key:"toPretty",value:function(){var e=2*this.curve.fieldSize;return[K(this.getX(),e),K(this.getY(),e)]}},{key:v,value:function(){return this.isInfinity()?"<EdwardsPoint: Infinity>":"<EdwardsPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}],[{key:"decode",value:function(e,t){H(e instanceof x);var f=e.decodeAdjusted(t),r=0!==f.testn(e.signBit);if(f.setn(e.signBit,0),f.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromY(f,r)}},{key:"fromJSON",value:function(e,t){if(H(e instanceof x),H(Array.isArray(t)),H(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();var f=b.fromJSON(t[0]),r=b.fromJSON(t[1]),i=e.point(f,r);return t.length>2&&null!=t[2]&&(i.pre=E.fromJSON(i,t[2])),i}}]),f}(M),E=function(){function e(){u(this,e),this.naf=null,this.windows=null,this.doubles=null,this.blinding=null,this.beta=null}return a(e,[{key:"map",value:function(e){H("function"==typeof e);var t=new this.constructor;return this.naf&&(t.naf=this.naf.map(e)),this.doubles&&(t.doubles=this.doubles.map(e)),t}},{key:"toJSON",value:function(){return{naf:this.naf?this.naf.toJSON():null,windows:this.windows?this.windows.toJSON():null,doubles:this.doubles?this.doubles.toJSON():null,blinding:this.blinding?this.blinding.toJSON():void 0}}},{key:"fromJSON",value:function(e,t){return H(e instanceof M),H(t&&"object"==typeof t),null!=t.naf&&(this.naf=J.fromJSON(e,t.naf)),null!=t.windows&&(this.windows=P.fromJSON(e,t.windows)),null!=t.doubles&&(this.doubles=R.fromJSON(e,t.doubles)),null!=t.blinding&&(this.blinding=Z.fromJSON(e,t.blinding)),this}}],[{key:"fromJSON",value:function(e,t){return(new this).fromJSON(e,t)}}]),e}(),J=function(){function e(t,f){u(this,e),this.width=t,this.points=f}return a(e,[{key:"map",value:function(e){H("function"==typeof e);var t,f=this.width,r=[],i=h(this.points);try{for(i.s();!(t=i.n()).done;){var n=t.value;r.push(e(n))}}catch(s){i.e(s)}finally{i.f()}return new this.constructor(f,r)}},{key:"toJSON",value:function(){return{width:this.width,points:this.points.slice(1).map((function(e){return e.toJSON()}))}}}],[{key:"fromJSON",value:function(e,t){H(e instanceof M),H(t&&"object"==typeof t),H(t.width>>>0===t.width),H(Array.isArray(t.points));var f,r=e.curve,i=t.width,n=[e],s=h(t.points);try{for(s.s();!(f=s.n()).done;){var d=f.value;n.push(r.pointFromJSON(d))}}catch(o){s.e(o)}finally{s.f()}return new this(i,n)}}]),e}(),P=function(){function e(t,f,r){u(this,e),this.width=t,this.bits=f,this.points=r}return a(e,[{key:"toJSON",value:function(){return{width:this.width,bits:this.bits,points:this.points.slice(1).map((function(e){return e.toJSON()}))}}}],[{key:"fromJSON",value:function(e,t){H(e instanceof M),H(t&&"object"==typeof t),H(t.width>>>0===t.width),H(t.bits>>>0===t.bits),H(Array.isArray(t.points));var f,r=e.curve,i=t.width,n=t.bits,s=[e],d=h(t.points);try{for(d.s();!(f=d.n()).done;){var o=f.value;s.push(r.pointFromJSON(o))}}catch(u){d.e(u)}finally{d.f()}return new this(i,n,s)}}]),e}(),R=function(){function e(t,f){u(this,e),this.step=t,this.points=f}return a(e,[{key:"map",value:function(e){H("function"==typeof e);var t,f=this.step,r=[],i=h(this.points);try{for(i.s();!(t=i.n()).done;){var n=t.value;r.push(e(n))}}catch(s){i.e(s)}finally{i.f()}return new this.constructor(f,r)}},{key:"toJSON",value:function(){return{step:this.step,points:this.points.slice(1).map((function(e){return e.toJSON()}))}}}],[{key:"fromJSON",value:function(e,t){H(e instanceof M),H(t&&"object"==typeof t),H(t.step>>>0===t.step),H(Array.isArray(t.points));var f,r=e.curve,i=t.step,n=[e],s=h(t.points);try{for(s.s();!(f=s.n()).done;){var d=f.value;n.push(r.pointFromJSON(d))}}catch(o){s.e(o)}finally{s.f()}return new this(i,n)}}]),e}(),Z=function(){function e(t,f){u(this,e),this.blind=t,this.unblind=f}return a(e,[{key:"toJSON",value:function(){return{blind:this.blind.toJSON(),unblind:this.unblind.toJSON()}}}],[{key:"fromJSON",value:function(e,t){H(e instanceof M),H(t&&"object"==typeof t);var f=e.curve;return new this(b.fromJSON(t.blind),f.pointFromJSON(t.unblind))}}]),e}(),F=function(){function e(t,f,r,i){u(this,e),this.beta=t,this.lambda=f,this.basis=r,this.pre=i}return a(e,[{key:"toJSON",value:function(){return{beta:this.beta.fromRed().toJSON(),lambda:this.lambda.toJSON(),basis:[this.basis[0].toJSON(),this.basis[1].toJSON()],pre:[this.pre[0],this.pre[1].toJSON(),this.pre[2].toJSON()]}}}],[{key:"fromJSON",value:function(e,t){return H(e instanceof I),H(t&&"object"==typeof t),H(Array.isArray(t.basis)),H(Array.isArray(t.pre)),H(2===t.basis.length),H(3===t.pre.length),H(t.pre[0]>>>0===t.pre[0]),new this(b.fromJSON(t.beta).toRed(e.red),b.fromJSON(t.lambda),[j.fromJSON(t.basis[0]),j.fromJSON(t.basis[1])],[t.pre[0],b.fromJSON(t.pre[1]),b.fromJSON(t.pre[2])])}}]),e}(),j=function(){function e(t,f){u(this,e),this.a=t,this.b=f}return a(e,[{key:"toJSON",value:function(){return{a:this.a.toJSON(),b:this.b.toJSON()}}}],[{key:"fromJSON",value:function(e){return H(e&&"object"==typeof e),new this(b.fromJSON(e.a),b.fromJSON(e.b))}}]),e}(),X={__proto__:null,P192:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"P192",ossl:"prime192v1",type:"short",endian:"be",hash:"SHA256",prime:"p192",p:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff fffffffc"],b:["64210519 e59c80e7 0fa7e9ab 72243049","feb8deec c146b9b1"],n:["ffffffff ffffffff ffffffff 99def836","146bc9b1 b4d22831"],h:"1",z:"-5",g:[["188da80e b03090f6 7cbf20eb 43a18800","f4ff0afd 82ff1012"],["07192b95 ffc8da78 631011ed 6b24cdd5","73f977a1 1e794811"],e]})}return f}(g),P224:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"P224",ossl:"secp224r1",type:"short",endian:"be",hash:"SHA256",prime:"p224",p:["ffffffff ffffffff ffffffff ffffffff","00000000 00000000 00000001"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff fffffffe"],b:["b4050a85 0c04b3ab f5413256 5044b0b7","d7bfd8ba 270b3943 2355ffb4"],n:["ffffffff ffffffff ffffffff ffff16a2","e0b8f03e 13dd2945 5c5c2a3d"],h:"1",z:"1f",g:[["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3","56c21122 343280d6 115c1d21"],["bd376388 b5f723fb 4c22dfe6 cd4375a0","5a074764 44d58199 85007e34"],e]})}return f}(g),P256:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"P256",ossl:"prime256v1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff ffffffff"],a:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff fffffffc"],b:["5ac635d8 aa3a93e7 b3ebbd55 769886bc","651d06b0 cc53b0f6 3bce3c3e 27d2604b"],n:["ffffffff 00000000 ffffffff ffffffff","bce6faad a7179e84 f3b9cac2 fc632551"],h:"1",z:"-a",g:[["6b17d1f2 e12c4247 f8bce6e5 63a440f2","77037d81 2deb33a0 f4a13945 d898c296"],["4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16","2bce3357 6b315ece cbb64068 37bf51f5"],e]})}return f}(g),P384:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"P384",ossl:"secp384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 ffffffff"],a:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 fffffffc"],b:["b3312fa7 e23ee7e4 988e056b e3f82d19","181d9c6e fe814112 0314088f 5013875a","c656398d 8a2ed19d 2a85c8ed d3ec2aef"],n:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff c7634d81 f4372ddf","581a0db2 48b0a77a ecec196a ccc52973"],h:"1",z:"-c",g:[["aa87ca22 be8b0537 8eb1c71e f320ad74","6e1d3b62 8ba79b98 59f741e0 82542a38","5502f25d bf55296c 3a545e38 72760ab7"],["3617de4a 96262c6f 5d9e98bf 9292dc29","f8f41dbd 289a147c e9da3113 b5f0b8c0","0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"],e]})}return f}(g),P521:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"P521",ossl:"secp521r1",type:"short",endian:"be",hash:"SHA512",prime:"p521",p:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff"],a:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffc"],b:["00000051 953eb961 8e1c9a1f 929a21a0","b68540ee a2da725b 99b315f3 b8b48991","8ef109e1 56193951 ec7e937b 1652c0bd","3bb1bf07 3573df88 3d2c34f1 ef451fd4","6b503f00"],n:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffa 51868783 bf2f966b 7fcc0148","f709a5d0 3bb5c9b8 899c47ae bb6fb71e","91386409"],h:"1",z:"-4",g:[["000000c6 858e06b7 0404e9cd 9e3ecb66","2395b442 9c648139 053fb521 f828af60","6b4d3dba a14b5e77 efe75928 fe1dc127","a2ffa8de 3348b3c1 856a429b f97e7e31","c2e5bd66"],["00000118 39296a78 9a3bc004 5c8a5fb4","2c7d1bd9 98f54449 579b4468 17afbd17","273e662c 97ee7299 5ef42640 c550b901","3fad0761 353c7086 a272c240 88be9476","9fd16650"],e]})}return f}(g),SECP256K1:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"SECP256K1",ossl:"secp256k1",type:"short",endian:"be",hash:"SHA256",prime:"k256",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe fffffc2f"],a:"0",b:"7",n:["ffffffff ffffffff ffffffff fffffffe","baaedce6 af48a03b bfd25e8c d0364141"],h:"1",z:"1",c:["0a2d2ba9 3507f1df 233770c2 a797962c","c61f6d15 da14ecd4 7d8d27ae 1cd5f852"],g:[["79be667e f9dcbbac 55a06295 ce870b07","029bfcdb 2dce28d9 59f2815b 16f81798"],["483ada77 26a3c465 5da4fbfc 0e1108a8","fd17b448 a6855419 9c47d08f fb10d4b8"],e],endo:{beta:["7ae96a2b 657c0710 6e64479e ac3434e9","9cf04975 12f58995 c1396c28 719501ee"],lambda:["5363ad4c c05c30e0 a5261c02 8812645a","122e22ea 20816678 df02967c 1b23bd72"],basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],pre:[384,["3086d221 a7d46bcd e86c90e4 9284eb15","3daa8a14 71e8ca7f e893209a 45dbb031"],["-","e4437ed6 010e8828 6f547fa9 0abfe4c4","221208ac 9df506c6 1571b4ae 8ac47f71"]]}})}return f}(g),BRAINPOOLP256:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"BRAINPOOLP256",ossl:"brainpoolP256r1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["a9fb57db a1eea9bc 3e660a90 9d838d72","6e3bf623 d5262028 2013481d 1f6e5377"],a:["7d5a0975 fc2c3057 eef67530 417affe7","fb8055c1 26dc5c6c e94a4b44 f330b5d9"],b:["26dc5c6c e94a4b44 f330b5d9 bbd77cbf","95841629 5cf7e1ce 6bccdc18 ff8c07b6"],n:["a9fb57db a1eea9bc 3e660a90 9d838d71","8c397aa3 b561a6f7 901e0e82 974856a7"],h:"1",z:"-2",g:[["8bd2aeb9 cb7e57cb 2c4b482f fc81b7af","b9de27e1 e3bd23c2 3a4453bd 9ace3262"],["547ef835 c3dac4fd 97f8461a 14611dc9","c2774513 2ded8e54 5c1d54c7 2f046997"],e]})}return f}(g),BRAINPOOLP384:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"BRAINPOOLP384",ossl:"brainpoolP384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b4 12b1da19 7fb71123","acd3a729 901d1a71 87470013 3107ec53"],a:["7bc382c6 3d8c150c 3c72080a ce05afa0","c2bea28e 4fb22787 139165ef ba91f90f","8aa5814a 503ad4eb 04a8c7dd 22ce2826"],b:["04a8c7dd 22ce2826 8b39b554 16f0447c","2fb77de1 07dcd2a6 2e880ea5 3eeb62d5","7cb43902 95dbc994 3ab78696 fa504c11"],n:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b3 1f166e6c ac0425a7","cf3ab6af 6b7fc310 3b883202 e9046565"],h:"1",z:"-5",g:[["1d1c64f0 68cf45ff a2a63a81 b7c13f6b","8847a3e7 7ef14fe3 db7fcafe 0cbd10e8","e826e034 36d646aa ef87b2e2 47d4af1e"],["8abe1d75 20f9c2a4 5cb1eb8e 95cfd552","62b70b29 feec5864 e19c054f f9912928","0e464621 77918111 42820341 263c5315"],e]})}return f}(g),BRAINPOOLP512:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"BRAINPOOLP512",ossl:"brainpoolP512r1",type:"short",endian:"be",hash:"SHA512",prime:null,p:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330871","7d4d9b00 9bc66842 aecda12a e6a380e6","2881ff2f 2d82c685 28aa6056 583a48f3"],a:["7830a331 8b603b89 e2327145 ac234cc5","94cbdd8d 3df91610 a83441ca ea9863bc","2ded5d5a a8253aa1 0a2ef1c9 8b9ac8b5","7f1117a7 2bf2c7b9 e7c1ac4d 77fc94ca"],b:["3df91610 a83441ca ea9863bc 2ded5d5a","a8253aa1 0a2ef1c9 8b9ac8b5 7f1117a7","2bf2c7b9 e7c1ac4d 77fc94ca dc083e67","984050b7 5ebae5dd 2809bd63 8016f723"],n:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330870","553e5c41 4ca92619 41866119 7fac1047","1db1d381 085ddadd b5879682 9ca90069"],h:"1",z:"7",g:[["81aee4bd d82ed964 5a21322e 9c4c6a93","85ed9f70 b5d916c1 b43b62ee f4d0098e","ff3b1f78 e2d0d48d 50d1687b 93b97d5f","7c6d5047 406a5e68 8b352209 bcb9f822"],["7dde385d 566332ec c0eabfa9 cf7822fd","f209f700 24a57b1a a000c55b 881f8111","b2dcde49 4a5f485e 5bca4bd8 8a2763ae","d1ca2b2f a8f05406 78cd1e0f 3ad80892"],e]})}return f}(g),X25519:function(e){n(f,e);var t=c(f);function f(){return u(this,f),t.call(this,{id:"X25519",ossl:"X25519",type:"mont",endian:"le",hash:"SHA512",prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"76d06",b:"1",n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000009"],["5f51e65e 475f794b 1fe122d3 88b72eb3","6dc2b281 92839e4d d6163a5d 81312c14"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["6be4f497 f9a9c2af c21fa77a d7f4a6ef","635a11c7 284a9363 e9a248ef 9c884415"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["141b0b68 06563d50 3de05885 280b5910","9ca5ee38 d7b56c9c 165db710 6377bbd8"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["68c59389 3d458e64 31c6ca00 45fb5015","20a44346 8eaa68dd 0f103842 048065b7"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["173a6c76 c2ba719b ce3935ff ba04afea","df5bbcb9 71559722 f0efc7bd fb7f9a36"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["3931c129 569e83a5 29482c14 e628b457","933bfc29 ed801b4d 68871483 92507b1a"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["46ce3ed6 a9617c5a d6b7d3eb 19d74ba8","6cc403d6 127fe4b2 9778eb7c 6daf84d3"]]]})}return f}(q),X448:function(e){n(f,e);var t=c(f);function f(){return u(this,f),t.call(this,{id:"X448",ossl:"X448",type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"262a6",b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000005"],["7d235d12 95f5b1f6 6c98ab6e 58326fce","cbae5d34 f55545d0 60f75dc2 8df3f6ed","b8027e23 46430d21 1312c4b1 50677af7","6fd7223d 457b5b1a"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["ba4d3a08 29b6112f 8812e51b a0bb2abe","bc1cb08e b48e5569 36ba50fd d2e7d68a","f8cb3216 0522425b 3f990812 abbe635a","d37a21e1 7551b193"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["45b2c5f7 d649eed0 77ed1ae4 5f44d541","43e34f71 4b71aa96 c945af01 2d182975","0734cde9 faddbda4 c066f7ed 54419ca5","2c85de1e 8aae4e6c"]]]})}return f}(q),MONT448:function(e){n(f,e);var t=c(f);function f(){return u(this,f),t.call(this,{id:"MONT448",ossl:null,type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:["b2cf97d2 d43459a9 31ed36b1 fc4e3cb5","5d93f8d2 22746997 60ccffc6 49961ed6","c5b05fca c24864ed 6fb59697 931b78da","84ddecd8 ca2b5cfb"],b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["ac0d24cc c6c75cb0 eb71f81e 7a6edf51","48e88aee 009a2a24 e795687e c28e125a","3e6730a6 0d46367b aa7fe99d 152128dc","41321bc7 7817f059"],["5a4437f6 80c0d0db 9b061276 d5d0ffcc","e786ff33 b6a53d30 98746425 82e66f09","4433dae7 7244a6e2 6b11e905 7228f483","556c41a5 913f55fe"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["bec92fd0 6da2acf2 b4e261e8 7cef0d34","22e75c18 3c589857 b71924e5 73c2f9ce","e18da5f2 466e2f39 3c2eedf0 f105a60a","b40c717d 4f1e1fd7"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["4136d02f 925d530d 4b1d9e17 8310f2cb","dd18a3e7 c3a767a8 48e6db19 8c3d0631","1e725a0d b991d0c6 c3d1120f 0efa59f5","4bf38e82 b0e1e028"]]]})}return f}(q),ED25519:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"ED25519",ossl:"ED25519",type:"edwards",endian:"le",hash:"SHA512",prefix:"SigEd25519 no Ed25519 collisions",context:!1,prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"-1",d:["52036cee 2b6ffe73 8cc74079 7779e898","00700a4d 4141d8ab 75eb4dca 135978a3"],n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["216936d3 cd6e53fe c0a4e231 fdd6dc5c","692cc760 9525a7b2 c9562d60 8f25d51a"],["66666666 66666666 66666666 66666666","66666666 66666666 66666666 66666658"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffec"]],[["2b832480 4fc1df0b 2b4d0099 3dfbd7a7","2f431806 ad2fe478 c4ee1b27 4a0ea0b0"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["547cdb7f b03e20f4 d4b2ff66 c2042858","d0bce7f9 52d01b87 3b11e4d8 b5f15f3d"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]]]})}return f}(x),ISO448:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"ISO448",ossl:null,type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["d78b4bdc 7f0daf19 f24f38c2 9373a2cc","ad461572 42a50f37 809b1da3 412a12e7","9ccc9c81 264cfe9a d0809970 58fb61c4","243cc32d baa156b9"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["79a70b2b 70400553 ae7c9df4 16c792c6","1128751a c9296924 0c25a07d 728bdc93","e21f7787 ed697224 9de732f3 8496cd11","69871309 3e9c04fc"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 80000000","00000000 00000000 00000000 00000000","00000000 00000001"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}return f}(x),ED448:function(e){n(f,e);var t=c(f);function f(e){return u(this,f),t.call(this,{id:"ED448",ossl:"ED448",type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffff6756"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["4f1970c6 6bed0ded 221d15a6 22bf36da","9e146570 470f1767 ea6de324 a3d3a464","12ae1af7 2ab66511 433b80e1 8b00938e","2626a82b c70cc05e"],["693f4671 6eb6bc24 88762037 56c9c762","4bea7373 6ca39840 87789c1e 05a0c2d7","3ad3ff1c e67c39c4 fdbd132c 4ed7c8ad","9808795b f230fa14"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}return f}(x)},D={__proto__:null,P192:null,P224:null,P256:null,P384:null,P521:null,SECP256K1:null,BRAINPOOLP256:null,BRAINPOOLP384:null,BRAINPOOLP512:null,X25519:null,X448:null,MONT448:null,ED25519:null,ISO448:null,ED448:null};function B(e,t,f){H(e instanceof b),H(!e.red),H(t>>>0===t),H(f>>>0===f);var r=new Array(f),i=e.bitLength()+1,n=1|e.sign();H(i<=f);for(var s=0;s<f;s++)r[s]=0;for(var d,o=0,u=0;o<i;)e.bit(o)!==u?(d=e.bits(o,t)+u,d-=(u=d>>t-1&1)<<t,r[o]=n*d,o+=t):o+=1;return H(0===u),r}function Y(e,t,f){for(var r=function(e,t,f){H(e instanceof b),H(t instanceof b),H(!e.red),H(!t.red),H(f>>>0===f);var r=[new Array(f),new Array(f)],i=Math.max(e.bitLength(),t.bitLength())+1,n=1|e.sign(),s=1|t.sign();H(i<=f);for(var d=0,o=0,u=0;u<i;u++){var a=e.bits(u,3),h=t.bits(u,3),l=(3&a)+d&3,c=(3&h)+o&3,v=0,y=0;if(3===l&&(l=-1),3===c&&(c=-1),1&l){var p=(7&a)+d&7;v=3!==p&&5!==p||2!==c?l:-l}if(1&c){var m=(7&h)+o&7;y=3!==m&&5!==m||2!==l?c:-c}r[0][u]=v*n,r[1][u]=y*s,2*d===1+v&&(d=1-d),2*o===1+y&&(o=1-o)}for(var S=i;S<f;S++)r[0][S]=0,r[1][S]=0;return r}(e,t,f),i=new Array(f),n=0;n<f;n++){var s=r[0][n],d=r[1][n];i[n]=w[3*(s+1)+(d+1)]}return i}function H(e,t){if(!e){var f=new Error(t||"Assertion failed");throw Error.captureStackTrace&&Error.captureStackTrace(f,H),f}}function L(e){H("function"==typeof e);try{return e()}catch(t){if("X is not a square mod P."===t.message||"Not invertible."===t.message)throw new Error("Invalid point.");throw t}}function C(e){var t=function(e){H(e instanceof b),H(e.red);var t=e.red.m;if(t.cmpn(3)<=0)return e.clone();if(2===t.modrn(3)){var f=t.ushln(1).isubn(1).idivn(3);return e.redPow(f)}var r=t.modrn(9);if(4===r){var i=t.ushln(1).iaddn(1).idivn(9),n=e.redPow(i);if(!n.redSqr().redMul(n).eq(e))throw new Error("X is not a cube mod P.");return n}if(7===r){var s=t.addn(2).idivn(9),d=e.redPow(s);if(!d.redSqr().redMul(d).eq(e))throw new Error("X is not a cube mod P.");return d}throw new Error("Not implemented.")}(e);if(1===e.red.m.modrn(3)){var f=new b(2).toRed(e.red),r=new b(3).toRed(e.red),i=f.redInvert(),n=r.redNeg().redSqrt().redMul(i),s=n.redNeg(),d=n.redSub(i),o=s.redSub(i),u=t.redMul(d),a=t.redMul(o);return[t,u,a]}return[t]}function U(e){var t,f=h(C(e));try{for(f.s();!(t=f.n()).done;){var r=t.value;if(r.redJacobi()>=0)return r}}catch(i){f.e(i)}finally{f.f()}throw new Error("X^(1/3) is not a square mod P.")}function T(e){return b.randomBits(e,32).toNumber()}function W(e,t){var f=new WeakMap;return function(r,i){var n=1&i,s=f.get(r);if(s&&null!==s[n])return s[n];var d=e.call(t,r,i);return f.has(r)||f.set(r,[null,null]),f.get(r)[n]=d,d}}function K(e,t){H(e instanceof b),H(t>>>0===t),7&t&&(t+=8-(7&t));var f=e.toString(16,t),r=[],i=[];H(0==(7&f.length));for(var n=0;n<f.length;n+=8)r.push(f.slice(n,n+8));for(var s=0;s<r.length;s+=4)i.push(r.slice(s,s+4).join(" "));return i}t.Curve=I,t.Point=M,t.ShortCurve=g,t.ShortPoint=N,t.JPoint=z,t.MontCurve=q,t.MontPoint=A,t.XPoint=_,t.EdwardsCurve=x,t.EdwardsPoint=O,t.curves=X,t.curve=function(e){H("string"==typeof e);var t=e.toUpperCase(),f=D[t];if(!f){var i=X[t];if(!i)throw new Error('Curve not found: "'.concat(e,'".'));for(var n=arguments.length,s=new Array(n>1?n-1:0),d=1;d<n;d++)s[d-1]=arguments[d];f=r(i,s),D[t]=f}return f},t.register=function(e,t){H("string"==typeof e),H("function"==typeof t);var f=e.toUpperCase();if(X[f])throw new Error('Curve already registered: "'.concat(e,'".'));X[f]=t,D[f]=null}}).call(this,f("HDXh").Buffer)}}]);
//# sourceMappingURL=2b38c15a-8d1f50873d22d5187791.js.map